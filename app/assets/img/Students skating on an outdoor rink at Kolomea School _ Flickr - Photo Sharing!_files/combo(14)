YUI.add("html-file-dragdrop",function(e){"use strict";var t="htmlFileDragDrop",n=t+"-drag-over",r=t+"-error",i=["image/png","image/jpeg"];e.HtmlFileDragDrop=function(t){e.config.win.File&&e.config.win.FileList&&e.config.win.FileReader&&t.dropZone&&(this.dropZone=e.one(t.dropZone),this.dropZone.on("dragover",this.handleDragOver.bind(this)),this.dropZone.on("dragleave",this.handleDragLeave.bind(this)),this.dropZone.on("drop",this.handleDrop.bind(this)))},e.HtmlFileDragDrop.prototype.reset=function(){this.dropZone.removeClass(r),this.dropZone.removeClass(n)},e.HtmlFileDragDrop.prototype.handleDragOver=function(e){e.halt(),this.reset(),this.dropZone.addClass(n)},e.HtmlFileDragDrop.prototype.handleDragLeave=function(e){e.halt(),this.reset()},e.HtmlFileDragDrop.prototype.showError=function(){this.dropZone.addClass(r)},e.HtmlFileDragDrop.prototype.handleDrop=function(e){var t,s;e.halt(),this.dropZone.removeClass(n),t=e._event.dataTransfer.files;if(t.length>1){this.dropZone.addClass(r),this.fire("drop",new Error("FILE_COUNT"));return}s=e._event.dataTransfer.files[0];if(s&&s.name){if(i.indexOf(s.type)<0){this.fire("drop",new Error("FILE_TYPE"));return}this.fire("drop",s)}},e.augment(e.HtmlFileDragDrop,e.EventTarget,!0,null,{prefix:t})},"@VERSION@",{affinity:"",requires:["event-custom"],optional:[]});
YUI.add("hermes-template-photo-selector",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){return'\n		<div class="photo-selector-search-list-yours">\n			<div class="photo-selector-search-list">\n				<div class="photo-selector-search-list-container">\n				</div>\n			</div>\n		</div>\n	'}function d(e,t){return'\n		<div class="photo-selector-search-list-contacts">\n			<div class="photo-selector-search-list">\n				<div class="photo-selector-search-list-container">\n				</div>\n			</div>\n		</div>\n	'}function v(e,t){return'\n		<div class="photo-selector-search-list-everyone">\n			<div class="photo-selector-search-list">\n				<div class="photo-selector-search-list-container">\n				</div>\n			</div>\n		</div>\n	'}function m(e,t){return'\n		<div class="photo-selector-search-list-marketplace"\n			<div class="photo-selector-search-list">\n				<div class="photo-selector-search-list-container">\n				</div>\n			</div>\n		</div>\n	'}function g(e,t){var r="",i;r+='\n<div class="marketplace-category-wrapper is-hiding">\n	',i=n.each.call(e,e.marketplaceCategories,{hash:{},inverse:c.noop,fn:c.program(10,y,t),data:t});if(i||i===0)r+=i;return r+="\n</div>\n",r}function y(e,t){var r="",i;return r+='\n		<div class="avatar album landscape double-large marketplace marketplace-category ',(i=n.className)?i=i.call(e,{hash:{},data:t}):(i=e.className,i=typeof i===f?i.apply(e):i),r+=l(i)+'" data-title="',(i=n.displayName)?i=i.call(e,{hash:{},data:t}):(i=e.displayName,i=typeof i===f?i.apply(e):i),r+=l(i)+'" data-value="',(i=n.id)?i=i.call(e,{hash:{},data:t}):(i=e.id,i=typeof i===f?i.apply(e):i),r+=l(i)+'">\n			<sup class="',(i=n.className)?i=i.call(e,{hash:{},data:t}):(i=e.className,i=typeof i===f?i.apply(e):i),r+=l(i)+'">',(i=n.displayName)?i=i.call(e,{hash:{},data:t}):(i=e.displayName,i=typeof i===f?i.apply(e):i),r+=l(i)+"</sup>\n		</div>\n	",r}function b(e,t){var r="",i,s;return r+='\n<div class="photo-selector-upload is-hiding">\n	<p class="upload-error"></p>\n	<div class="drop-zone">\n		<div class="drop-zone-content">\n			<div class="balls"></div>\n			<input type="file" class="file-select" name="file-select" accept="image/jpeg, image/png" />\n			<p><i class="upload-icon"></i>',s={hash:{intlName:"wallart.DRAG_DROP_TO_UPLOAD"},data:t},r+=l((i=n.intlHTMLMessage||e.intlHTMLMessage,i?i.call(e,s):h.call(e,"intlHTMLMessage",s)))+"</p>\n			<p>",s={hash:{intlName:"wallart.PHOTOS_UPLOADED_AS_PRIVATE"},data:t},r+=l((i=n.intlHTMLMessage||e.intlHTMLMessage,i?i.call(e,s):h.call(e,"intlHTMLMessage",s)))+'</p>\n		</div>\n	</div>\n	<ul class="preview"></ul>\n</div>\n',r}function w(e,t){return'\n<div class="group-photo-selector-photos-wrapper">\n	<div class="group-photo-selector-photos photo-selector-photos">\n		<div class="group-photo-selector-photos-container">\n		</div>\n	</div>\n</div>\n'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='<div class="photo-selector-title-bar hidden">\n	<div class="back-to-list">',a={hash:{intlName:"common.PHOTO_SELECTOR_BACK_TO_ALBUM_LIST"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</div>\n	<div class="title"></div>\n</div>\n\n<div class="photo-selector-photos-wrapper">\n	<div class="photo-selector-photos">\n		<div class="photo-selector-photos-container">\n		</div>\n		<div class="loader"><div class="balls"></div></div>\n	</div>\n</div>\n\n<div class="photo-selector-search-lists-wrapper is-hiding">\n	',u=n["if"].call(t,(o=t.searchable,o==null||o===!1?o:o.yours),{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(u||u===0)s+=u;s+="\n\n	",u=n["if"].call(t,(o=t.searchable,o==null||o===!1?o:o.contacts),{hash:{},inverse:c.noop,fn:c.program(3,d,i),data:i});if(u||u===0)s+=u;s+="\n\n	",u=n["if"].call(t,(o=t.searchable,o==null||o===!1?o:o.everyone),{hash:{},inverse:c.noop,fn:c.program(5,v,i),data:i});if(u||u===0)s+=u;s+="\n\n	",u=n["if"].call(t,(o=t.searchable,o==null||o===!1?o:o.marketplace),{hash:{},inverse:c.noop,fn:c.program(7,m,i),data:i});if(u||u===0)s+=u;s+="\n</div>\n\n",u=n["if"].call(t,t.enableMarketplaceProducts,{hash:{},inverse:c.noop,fn:c.program(9,g,i),data:i});if(u||u===0)s+=u;s+="\n\n",u=n["if"].call(t,t.hasUploadCapabilities,{hash:{},inverse:c.noop,fn:c.program(12,b,i),data:i});if(u||u===0)s+=u;s+="\n\n",u=n["if"].call(t,t.hasGroupCapabilities,{hash:{},inverse:c.noop,fn:c.program(14,w,i),data:i});if(u||u===0)s+=u;return s+="\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-selector",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-photo-list-demo-subview",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o,u=n.helperMissing,a=this.escapeExpression;return o={hash:{},data:i},a((s=n.outlet||t.outlet,s?s.call(t,t["photo-list-view"],o):u.call(t,"outlet",t["photo-list-view"],o)))}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-list-demo-subview",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-selector-photolist-view",function(e){e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{initializer:function(t){return t.photolistViewClasses&&(t.additionalViewClasses=t.photolistViewClasses),t.photoListConfig=e.merge(t.primaryPhotoListConfig),this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},subviewConfig:{"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},loadState:function(){return e.Promise.resolve()},buildContainer:function(){var e=this.templates("photo-list-demo-subview")({"photo-list-view":this.subviews["photo-list-view"].get("container")});return this.setContainerHTML(e),this},activate:function(){return this}})},"@VERSION@",{requires:["flickr-view","photo-list-view","hermes-template-photo-list-demo-subview"]});
YUI.add("hermes-template-search-photos-single-row",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){var r="",i;r+='\n	<h5 class="search-results-header">',i=n.unless.call(e,e.loading,{hash:{},inverse:f.noop,fn:f.program(2,h,t),data:t});if(i||i===0)r+=i;(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===u?i.apply(e):i),r+=a(i)+" ",i=n["if"].call(e,e.loading,{hash:{},inverse:f.noop,fn:f.program(6,v,t),data:t});if(i||i===0)r+=i;r+="</h5>\n	",i=n["if"].call(e,e.loading,{hash:{},inverse:f.program(10,g,t),fn:f.program(8,m,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function h(e,t){var r;return r=n.unless.call(e,e.singleResult,{hash:{},inverse:f.noop,fn:f.program(3,p,t),data:t}),r||r===0?r:""}function p(e,t){var r="",i,s;r+='<a href="',(i=n.viewAll)?i=i.call(e,{hash:{},data:t}):(i=e.viewAll,i=typeof i===u?i.apply(e):i),r+=a(i)+'" class="view-more-link"',i=n["if"].call(e,e.viewAllDataTrack,{hash:{},inverse:f.noop,fn:f.program(4,d,t),data:t});if(i||i===0)r+=i;return r+=">",s={hash:{intlName:"search.VIEW_ALL_COUNT",count:e.total},data:t},r+=a((i=n.intlHTMLMessage||e.intlHTMLMessage,i?i.call(e,s):l.call(e,"intlHTMLMessage",s)))+"</a>",r}function d(e,t){var r="",i;return r+=' data-track="',(i=n.viewAllDataTrack)?i=i.call(e,{hash:{},data:t}):(i=e.viewAllDataTrack,i=typeof i===u?i.apply(e):i),r+=a(i)+'"',r}function v(e,t){return'<div class="flickr-dots inline"></div>'}function m(e,t){var r="",i;return r+='\n		<div style="height: ',(i=n.placeholderHeight)?i=i.call(e,{hash:{},data:t}):(i=e.placeholderHeight,i=typeof i===u?i.apply(e):i),r+=a(i)+'px;"></div>\n	',r}function g(e,t){var r="",i,s;return r+="\n		",s={hash:{},data:t},r+=a((i=n.outlet||e.outlet,i?i.call(e,e["photo-list-view"],s):l.call(e,"outlet",e["photo-list-view"],s)))+"\n	",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this,l=n.helperMissing;o=n.unless.call(t,t.emptySearch,{hash:{},inverse:f.noop,fn:f.program(1,c,i),data:i});if(o||o===0)s+=o;return s+="\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/search-photos-single-row",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-lite-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{update:e.PhotoModelHelper.updateEngagement},toggleFave:e.PhotoModelHelper.toggleFave,addAsFave:e.PhotoModelHelper.addAsFave,getLargestSize:e.PhotoModelHelper.getLargestSize,getSizeToFit:e.PhotoModelHelper.getSizeToFit,getSizeIfExact:e.PhotoModelHelper.getSizeIfExact,isSizeSquare:e.PhotoModelHelper.isSizeSquare,isPhotoSquare:e.PhotoModelHelper.isPhotoSquare,attributes:{owner:{readOnly:!0,isModel:!0,getter:function(e,t){var n=this;return{id:n.getValue(t,"ownerNsid"),getValue:function(e){return e==="id"?n.getValue(t,"ownerNsid"):e==="nsid"?n.getValue(t,"ownerNsid"):e==="url"?n.getValue(t,"ownerUrl"):n.getValue(t,e)},toJSON:function(){return{id:n.getValue(t,"ownerNsid"),url:n.getValue(t,"ownerUrl"),pathAlias:n.getValue(t,"pathAlias"),username:n.getValue(t,"username"),realname:n.getValue(t,"realname"),displayname:n.getValue(t,"displayname"),nsid:n.getValue(t,"ownerNsid"),ownerUrl:n.getValue(t,"ownerUrl"),isMe:n.getValue(t,"isMe")}},exists:function(e){return!1}}}},pathAlias:e.PersonModelHelper.attributes.pathAlias,username:e.PersonModelHelper.attributes.username,realname:e.PersonModelHelper.attributes.realname,displayname:e.PersonModelHelper.attributes.displayname,nsid:e.PersonModelHelper.attributes.nsid,ownerUrl:e.PersonModelHelper.attributes.url,isMe:e.PersonModelHelper.attributes.isMe,engagement:{readOnly:!0,isModel:!0,getter:function(e,t){var n=this;return{getValue:function(e){return n.getValue(t,e)},toJSON:function(){return{ownerNsid:n.getValue(t,"ownerNsid"),isFaved:n.getValue(t,"isFaved"),faveCount:n.getValue(t,"faveCount"),commentCount:n.getValue(t,"commentCount"),canFave:n.getValue(t,"canFave")}},exists:function(e){return!1}}}},curation:{readOnly:!0,isModel:!0,getter:function(e,t){var n=this;return{getValue:function(e){return n.getValue(t,e)},toJSON:function(){return{is3MP:n.getValue(t,"is3MP"),ownerCountryApproved:n.getValue(t,"ownerCountryApproved"),ownerFollowedByCurators:n.getValue(t,"ownerFollowedByCurators"),ownerAdded:n.getValue(t,"ownerAdded"),ownerPassedOver:n.getValue(t,"ownerPassedOver"),statusColor:n.getValue(t,"statusColor")}},exists:function(e){return!1}}}},ownerNsid:e.PhotoModelHelper.attributes.ownerNsid,isFaved:e.PhotoModelHelper.attributes.isFaved,faveCount:e.PhotoModelHelper.attributes.faveCount,commentCount:e.PhotoModelHelper.attributes.commentCount,canFave:e.PhotoModelHelper.attributes.canFave,is3MP:e.PhotoModelHelper.attributes.is3MP,ownerCountryApproved:e.PhotoModelHelper.attributes.ownerCountryApproved,ownerFollowedByCurators:e.PhotoModelHelper.attributes.ownerFollowedByCurators,ownerAdded:e.PhotoModelHelper.attributes.ownerAdded,ownerPassedOver:e.PhotoModelHelper.attributes.ownerPassedOver,statusColor:e.PhotoModelHelper.attributes.statusColor,title:e.PhotoModelHelper.attributes.title,description:e.PhotoModelHelper.attributes.description,mediaType:e.PhotoModelHelper.attributes.mediaType,license:e.PhotoModelHelper.attributes.license,isVideo:e.PhotoModelHelper.attributes.isVideo,isOwner:e.PhotoModelHelper.attributes.isOwner,sizes:e.PhotoModelHelper.attributes.sizes,descendingSizes:e.PhotoModelHelper.attributes.descendingSizes,ascendingSizes:e.PhotoModelHelper.attributes.ascendingSizes,aspectRatio:e.PhotoModelHelper.attributes.aspectRatio,needsInterstitial:e.PhotoModelHelper.attributes.needsInterstitial,canComment:e.PhotoModelHelper.attributes.canComment,url:e.PhotoModelHelper.attributes.url,rotation:e.PhotoModelHelper.attributes.rotation,isMarketplaceLicensable:e.PhotoModelHelper.attributes.isMarketplaceLicensable,marketplaceLicensingUrl:e.PhotoModelHelper.attributes.marketplaceLicensingUrl,oWidth:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},oHeight:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},hasInvalidColorspaceForPrint:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isMarketplacePrintable:{defaultFn:function(e){return!1}}}})},"@VERSION@",{requires:["flickr-model-registry","photo-model-helper","person-model-helper","flickr-favorites-add-updater","flickr-favorites-remove-updater","photo-models","photo-engagement-models","person-models"]});
YUI.add("search-photos-lite-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return t.getPhotoLiteModels=!0,e.ListFetchers["flickr-photos-search"].run(t,this.appContext)}},attributes:{photos:{isCollection:!0,pageFetch:{fetchParams:{getPhotoLiteModels:!0},listFetcher:e.ListFetchers["flickr-photos-search"],listItemIdField:"photoId"}},totalItems:{setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},apiParams:{writeOnce:"initOnly"},emptyQuery:{defaultValue:!1}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-search-fetcher","attribute-helpers"]});
YUI.add("flickr-photos-search-fetcher",function(e,t){"use strict";function i(t,n){var r=e.merge(e.SearchHelper.UNIFIED_DEFAULT_PARAMS,{extras:e.APIHelper.request[t.getPhotoLiteModels?"getRebootPhotoLiteExtras":"getRebootPhotoExtras"](),per_page:t.perPage||50,page:t.page||"1",lang:t.lang}),i;return t.fetchGeo&&(r.extras+=",geo"),n.flipper.isFlipped("display-marketplace-licensable")&&(r.extras+=",is_marketplace_licensable"),t.additionalExtras&&(r.extras+=","+t.additionalExtras.join(",")),i=e.merge(r,t.apiParams||{}),YUI.Env.isServer&&e.SearchHelper.unescapeParameters(i),e.SearchHelper.isParameterlessSearch(i)?null:i}function s(t,n){var r=t[0],i=t[1],s=t[2],o,u,a,f={id:n.id||e.SearchUrl.EMPTY_SEARCH_ID,apiParams:{},emptyQuery:!!n.emptyQuery,photos:[]},l,c,h;n.id&&n.id!==e.SearchUrl.EMPTY_SEARCH_ID&&(f.apiParams=e.QueryString.parse(n.id));if(!n.id)throw new ReferenceError("No `id` provided by request.");if(!n.useV2API&&(!r.photos||!r.photos.photo)){var p=new Error("No `photos.photo` property returned by search API v1.");throw p.fatal=!0,p}var d=n.useV2API?r.body:r.photos.photo;return n.getPhotoLiteModels?a=d.map(function(t){return c=e.APIHelper.response.parsePhotoLite(t),s.addOrUpdate(c)}):(a=e.APIHelper.response.parsePhotos({photos:r.photos.photo,photoModelRegistry:s,personModelRegistry:t[3],photoEngagementModelRegistry:t[4],photoStatsModelRegistry:t[5],photoCurationModelRegistry:t[6]}),n.fetchGeo&&(o=t[6],r.photos.photo.forEach(function(e){typeof e.latitude!="undefined"?l={id:e.id,hasGeo:!0,latitude:e.latitude,longitude:e.longitude}:l={id:e.id,hasGeo:!1},o.addOrUpdate(l)}))),f.photos={perPage:n.useV2API?n.perPage:r.photos.perpage,page:n.useV2API?n.page:r.photos.page,pageContent:a,totalItems:n.useV2API?r.headers.totalCount:parseInt(r.photos.total,10),totalPages:n.useV2API?parseInt(r.headers.totalCount/n.perPage,10):r.photos.pages/n.perPage},!n.useV2API&&r.photos.maxAllowedResults&&(f.photos.totalItems=Math.min(r.photos.maxAllowedResults,parseInt(r.photos.total,10))),!n.useV2API&&r.photos.maxAllowedPages&&(f.photos.totalPages=Math.min(r.photos.maxAllowedPages,r.photos.pages)),f.totalItems=n.useV2API?r.headers.totalCount:parseInt(r.photos.total,10),i.exists(f.id)?(u=i.getValue(f.id,"photos").getList(),h=u.filter(function(e){return!!e}).reduce(function(e,t){return e[t.id]=!0,e},{}),f.photos.pageContent=f.photos.pageContent.filter(function(e){return!h[e.id]}),f.photos.page===1&&(f.photos.forceAppend=!0),i.addOrUpdate(f)):i.add(f),a}function o(i,s){var o=this,u="flickr.photos.search",a=i.emptyQuery?{}:this._processParams(e.merge({lang:s.lang||e.config.lang},i),s),f;a||(i.emptyQuery=!0);if(i.useV2API){var l=new n({scheme:"https"},{logger:{log:function(e){r.info(e,{topic:"flickr-sdk"})}}}),c={orderBy:"interestingness",query:i.apiParams.tags||i.apiParams.text,pageNumber:i.page-1>=0?i.page-1:0,pageSize:i.perPage};i.minDateTaken&&i.maxDateTaken&&(c.context="dateTaken:["+i.minDateTaken+" TO "+i.maxDateTaken+"]"),f=[l.request().media().search(c.query).get(c).then(function(e){return e},function(e){return r.warn("API V2 Search returned a non valid response"),{body:[],headers:{totalCount:0}}})]}else f=[i.emptyQuery?e.Promise.resolve({photos:{photo:[]}}):s.callAPI(u,a)];return i.getPhotoLiteModels?f=f.concat([s.getModelRegistry("search-photos-lite-models"),s.getModelRegistry("photo-lite-models")]):f=f.concat([s.getModelRegistry("search-photos-models"),s.getModelRegistry("photo-models"),s.getModelRegistry("person-models"),s.getModelRegistry("photo-engagement-models"),s.getModelRegistry("photo-stats-models"),s.getModelRegistry("photo-geo-models"),s.getModelRegistry("photo-curation-models")]),e.Promise.all(f).then(function(e){return o._processResponse(e,i)},e.FetcherErrorLogger(t))}var n=require("flickr-js-sdk"),r=require("lib/flog")(t);e.namespace("ListFetchers")["flickr-photos-search"]={run:o,_processParams:i,_processResponse:s}},"@VERSION@",{requires:["flickr-promise","search-helper","search-url","api-helper","querystring-parse-simple"],optional:["search-photos-models","search-photos-lite-models","photo-models","photo-lite-models","person-models","photo-engagement-models","photo-stats-models","photo-curation-models","photo-geo-models"],optionalRequires:["flickr-js-sdk"]});
YUI.add("search-photos-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-photos-search"].run(t,this.appContext)}},attributes:{photos:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-photos-search"],listItemIdField:"photoId"}},totalItems:{setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},apiParams:{writeOnce:"initOnly"},emptyQuery:{defaultValue:!1}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-search-fetcher"]});
YUI.add("photo-selector-limited-rows-photolist-view",function(e){e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return t.photolistViewClasses&&(t.additionalViewClasses=t.photolistViewClasses),t.photoListConfig=e.merge(t.primaryPhotoListConfig),this.searchUrl=t.searchUrl,this.listId=t.listId,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},subviewConfig:{"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},loadState:function(){return this.appContext.getModel("search-photos-lite-models",this.searchUrl.getId(),{}).then(function(e){this.searchModel=e,e.getValue("totalItems")<=0&&this.set("emptySearch",!0)}.bind(this))},buildContainer:function(){var e="search.YOUR_PHOTOS";return this.listId==="contacts"?e="search.FROM_YOUR_CONTACTS":this.listId==="everyone"&&(e="search.EVERYONES_PHOTOS"),this.setContainerHTML(this.templates("search-photos-single-row")({emptySearch:this.get("emptySearch"),total:this.searchModel.getValue("totalItems"),singleResult:this.searchModel.getValue("totalItems")===1,viewAll:"#"+this.listId,"photo-list-view":this.subviews["photo-list-view"].get("container"),title:this.intlMessage({intlName:e})})),this},activate:function(){return this.registerEventHandler(this.get("container").on("click",this.handleClick.bind(this))),this},handleClick:function(e){e.halt();var t=e.target,n;t.hasClass("view-more-link")&&(n=t.getDOMNode().href.split("#")[1],this.fire("subviewViewEvent","viewEntireSearchList",{list:n,searchUrl:this.searchUrl}))}},{ATTRS:{emptySearch:{value:!1}}})},"@VERSION@",{requires:["flickr-view","photo-list-view","hermes-template-search-photos-single-row","search-photos-lite-models","photo-selector-css"],langBundles:["common","search"]});
YUI.add("hermes-template-photo-selector-photo-list-photo-interaction",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function h(e,t){var r="",i,s;return r+='<a href="'+f((i=(i=(i=e.photo,i==null||i===!1?i:i.owner),i==null||i===!1?i:i.url),typeof i===a?i.apply(e):i))+'" class="attribution">',s={hash:{intlName:"common.BY_USER",user:(i=(i=e.photo,i==null||i===!1?i:i.owner),i==null||i===!1?i:i.displayname)},data:t},r+=f((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+"</a>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=n.helperMissing,c=this;s+='\n<div class="photo-list-photo-interaction">\n	<div class="square"></div>\n	<div class="interaction-bar">\n		<div class="text">\n			<a href="',(o=n.photoPageUrl)?o=o.call(t,{hash:{},data:i}):(o=t.photoPageUrl,o=typeof o===a?o.apply(t):o),s+=f(o)+'" class="title">'+f((o=(o=t.photo,o==null||o===!1?o:o.title),typeof o===a?o.apply(t):o))+"</a>\n			",u=n["if"].call(t,(o=(o=t.photo,o==null||o===!1?o:o.owner),o==null||o===!1?o:o.displayname),{hash:{},inverse:c.noop,fn:c.program(1,h,i),data:i});if(u||u===0)s+=u;return s+="\n		</div>\n	</div>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-selector-photo-list-photo-interaction",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-selector-photolist-interaction-view",function(e){var t=require("lib/helpers/type-validator");"use strict",e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){var e=this.get("model");return this.setContainerHTML(this.templates("photo-selector-photo-list-photo-interaction")({photo:e.toJSON(),photoPageUrl:this.get("photoPageUrl")})),this},activate:function(){return this.registerEventHandler(this.get("container").on("click",this.selectPhoto.bind(this))),this.registerEventHandler(e.on("photoSelector:subviewEvent",this.handleOtherPhotoSelected,this)),this.get("isActive")||this.get("container").removeClass("active"),this},selectPhoto:function(t){t.halt(),this.set("isActive",!0),this.get("container").addClass("active"),e.fire("photoSelector:subviewEvent",{eventName:"selectPhotoFromPhotoList",id:this.get("id")})},handleOtherPhotoSelected:function(e){if(e.eventName==="selectPhotoFromPhotoList"&&this.get("isActive")){if(e.id===this.get("id"))return;this.set("isActive",!1),this.get("container")._node&&this.get("container").removeClass("active")}}},{ATTRS:{id:{writeOnce:"initOnly",validator:function(e,n){return t.photoId(e)}},model:{writeOnce:"initOnly"},photoPageUrl:{writeOnce:"initOnly"}}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-selector-photo-list-photo-interaction","photo-list-photo-interaction-css","attribute-helpers"],optionalRequires:["fluid"],langBundles:["common"]});
YUI.add("hermes-template-photo-selector-sets-photolist-set-interaction",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=n.helperMissing;return s+='\n<div class="photo-list-album-interaction photo-selector-album dark">\n	<div class="interaction-bar">\n		<h4 class="album-title">'+f((o=(o=t.album,o==null||o===!1?o:o.title),typeof o===a?o.apply(t):o))+'</h4>\n		<span class="album-photo-count">',u={hash:{intlName:"models.PLURAL_PHOTOS",count:(o=t.album,o==null||o===!1?o:o.totalCount)},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):l.call(t,"intlMessage",u)))+"</span>\n	</div>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-selector-sets-photolist-set-interaction",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-selector-sets-photolist-interaction-view",function(e){var t=require("lib/helpers/type-validator");"use strict",e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){return this.appContext.getModel(this.get("engagementModelName"),this.get("id")).then(function(e){this.set("engagement",e)}.bind(this))},buildContainer:function(){return this.setContainerHTML(this.templates("photo-selector-sets-photolist-set-interaction")({album:this.get("model").toJSON(),albumPageUrl:this.get("albumPageUrl")})),this},activate:function(){return this.registerEventHandler(this.get("container").on("click",this.selectSet.bind(this))),this},selectSet:function(t){t.halt(),e.fire("photoSelector:subviewEvent",{eventName:"selectSetFromPhotoList",id:this.get("id"),title:this.get("model").getValue("title")})},destructor:function(){}},{ATTRS:{id:{writeOnce:"initOnly",validator:function(e,n){return t.photoId(e)}},model:{writeOnce:"initOnly"},albumPageUrl:{writeOnce:"initOnly"},engagement:{value:null},engagementModelName:{writeOnce:"initOnly",value:null,validator:function(t,n){return e.AttributeHelpers.validateString(t)}}}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-selector-sets-photolist-set-interaction","photo-list-album-interaction-css","attribute-helpers"],optionalRequires:["fluid"],langBundles:["models"]});
YUI.add("photo-selector-view",function(e,t){var n=require("lib/flog")(t),r=150,i=200,s={};s={horizontal:20,vertical:20},e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.get("container").getHTML()===""&&this.setContainerHTML(this.templates("flickr-balls")({})),this.photoListView,this.searchPhotoListViews=[],this.publicOnlyGroups=e.publicOnlyGroups,this.isUploading=!1,this},loadState:function(){var t={photostreamModel:this.appContext.getModel("photostream-models",this.appContext.getViewer().nsid),setsModel:this.appContext.getModel("sets-models",this.appContext.getViewer().nsid)};return this.get("enableMarketplaceProducts")&&(t.marketplaceCategoryListModel=this.appContext.getModel("marketplace-categories-list-models",1)),(new e.FlickrPromise(t)).then(function(e){this.set("photostreamModel",e.photostreamModel),this.set("setsModel",e.setsModel),this.get("enableMarketplaceProducts")&&this.set("marketplaceCategoryListModel",e.marketplaceCategoryListModel);if(this.get("groupId"))return this.appContext.getModel("group-pool-models",this.get("groupId")).then(function(e){this.set("groupModel",e)}.bind(this),function(e){n.error("error loading group model",{err:e})})}.bind(this))},moveElementToFirstInArray:function(e,t,n){var r;return e.forEach(function(e,i){e[n]===t&&(r=i)}),e.unshift(e.splice(r,1)[0]),e},buildContainer:function(){var e,t,n=[];return this.get("enableMarketplaceProducts")&&(n=this.get("marketplaceCategoryListModel").getValue("categories").toJSON()),t={hasUploadCapabilities:this.get("hasUploadCapabilities"),enableMarketplaceProducts:this.get("enableMarketplaceProducts"),marketplaceCategories:n,searchable:this.get("searchable"),hasGroupCapabilities:this.get("groupId")},e=this.templates("photo-selector")(t),this.setContainerHTML(e),this},loadPhotoList:function(t,i){var o=this,u=this.get("container"),a=u.one(".photo-selector-photos-wrapper"),f;this.photoListView&&this.photoListView.destroy(),i||(i=!1),f={modelParams:t,parentName:this.name,paginateOnScroll:!0,parentContainer:a,relayoutOnResize:!0,interactionViewName:this.get("interactionViewName")},this.get("itemFilterFunction")&&(f.itemFilterFunction=this.get("itemFilterFunction")),f.layout={targetRowHeight:r,containerWidth:f.parentContainer.get("offsetWidth"),containerPadding:{top:10,right:0,bottom:10,left:0},itemSpacing:s,forceAspectRatio:1,alwaysDisplayOrphans:!1,awakeBoundsToViewportSizeRatio:5,viewportContainerNodeHeight:a.get("offsetHeight")},this.appContext.params.primaryPhotoListConfig=f,this.appContext.getView(this.get("photoListViewName"),{appContext:this.appContext,primaryPhotoListConfig:f,isActiveViewAgnostic:!0,container:u.one(".photo-selector-photos-container")}).then(function(t){return t.initialize().then(function(t){var n,r=u.one(".photo-selector-photos-container .photo-list-view");a.getDOMNode().scrollTop=0,o.photoListView=t,u.one(".loader").addClass("loaded"),i&&!r.hasChildNodes()&&(n=e.Node.create('<p class="no-results">'+o.intlMessage({intlName:"search.NO_MATCHES_FOR_QUERY_TERM_YOUR"})+"</p>"),r.empty().append(n)),o.set("selected",null),e.fire("photoSelector:unselected")})},function(e){n.error("Error getting view",{err:e})})},loadGroupPhotoList:function(t){var i=this,o=this.get("container"),u=o.one(".group-photo-selector-photos-wrapper"),a;this.photoListView&&this.photoListView.destroy(),a={modelParams:t,parentName:this.name,paginateOnScroll:!0,parentContainer:u,relayoutOnResize:!0,interactionViewName:this.get("interactionViewName")},this.get("itemFilterFunction")&&(a.itemFilterFunction=this.get("itemFilterFunction")),a.layout={targetRowHeight:r,containerWidth:a.parentContainer.get("offsetWidth"),containerPadding:{top:10,right:0,bottom:10,left:0},itemSpacing:s,forceAspectRatio:1,alwaysDisplayOrphans:!1,awakeBoundsToViewportSizeRatio:5,viewportContainerNodeHeight:u.get("offsetHeight")},this.appContext.params.primaryPhotoListConfig=a,this.appContext.getView(this.get("photoListViewName"),{appContext:this.appContext,primaryPhotoListConfig:a,isActiveViewAgnostic:!0,container:u}).then(function(t){return t.initialize().then(function(t){var n,r=o.one(".group-photo-selector-photos-container .photo-list-view");u.getDOMNode().scrollTop=0,i.photoListView=t,o.one(".loader").addClass("loaded"),r.hasChildNodes()||(n=e.Node.create('<p class="no-results">'+i.intlMessage({intlName:"groups.GROUP_POOL_CONTAINS_NO_PUBLIC_PHOTOS"})+"</p>"),r.empty().append(n)),i.set("selected",null),e.fire("photoSelector:unselected")})},function(e){n.error("Error getting view",{err:e})})},loadSetsPhotoList:function(t){var r=this,o=this.get("container"),u;this.photoListView&&this.photoListView.destroy(),u={modelParams:t,parentName:this.name,paginateOnScroll:!0,parentContainer:o.one(".photo-selector-photos-wrapper"),relayoutOnResize:!0,interactionViewName:this.get("setsInteractionViewName"),engagementModelName:"set-models",viewBeaconRestrictedAttribute:"primaryNeedsInterstitial"},u.layout={targetRowHeight:i,containerWidth:u.parentContainer.get("offsetWidth"),containerPadding:{top:14,right:0,bottom:14,left:0},itemSpacing:s,forceAspectRatio:1,alwaysDisplayOrphans:!1,awakeBoundsToViewportSizeRatio:5,viewportContainerNodeHeight:o.one(".photo-selector-photos-wrapper").get("offsetHeight")},this.appContext.params.primaryPhotoListConfig=u,this.appContext.getView(this.get("photoListViewName"),{appContext:this.appContext,primaryPhotoListConfig:u,isActiveViewAgnostic:!0,container:o.one(".photo-selector-photos-container")}).then(function(t){return t.initialize().then(function(t){o.one(".photo-selector-photos-wrapper").getDOMNode().scrollTop=0,r.photoListView=t,o.one(".loader").addClass("loaded"),r.set("selected",null),e.fire("photoSelector:unselected")})},function(e){n.error("Error getting view",{err:e})})},loadSearchPhotoList:function(t){var i=this,o=this.get("container"),u,a=t.photoListContainerSelector?o.one(t.photoListContainerSelector):o.one(".photo-selector-photos-container"),f=t.parentContainerSelector?
o.one(t.parentContainerSelector):o.one(".photo-selector-photos-wrapper"),l=t.maxNumRows?this.get("limitedRowsPhotoListViewName"):this.get("photoListViewName");this.searchPhotoListViews&&this.searchPhotoListViews[t.listId]&&this.searchPhotoListViews[t.listId].destroy(),u={modelParams:t.modelParams,parentName:this.name,paginateOnScroll:!0,parentContainer:f,relayoutOnResize:!0,interactionViewName:this.get("interactionViewName"),engagementModelName:"photo-lite-models"},this.get("itemFilterFunction")&&(u.itemFilterFunction=this.get("itemFilterFunction")),u.layout={targetRowHeight:r,containerWidth:u.parentContainer.get("offsetWidth"),containerPadding:{top:10,right:0,bottom:10,left:0},itemSpacing:s,forceAspectRatio:1,maxNumRows:t.maxNumRows?t.maxNumRows:Number.POSITIVE_INFINITY,alwaysDisplayOrphans:t.alwaysDisplayOrphans?t.alwaysDisplayOrphans:!1,awakeBoundsToViewportSizeRatio:5,viewportContainerNodeHeight:f.get("offsetHeight")},this.appContext.params.primaryPhotoListConfig=u,this.appContext.getView(l,{appContext:this.appContext,primaryPhotoListConfig:u,isActiveViewAgnostic:!0,container:a,searchUrl:t.searchUrl,listId:t.listId}).then(function(n){return n.initialize().then(function(n){i.registerEventHandler(n.on("subviewViewEvent",i.handleSubviewEvent,i)),o.one(".photo-selector-search-lists-wrapper").getDOMNode().scrollTop=0,t.parentContainerSelector&&(o.one(t.parentContainerSelector).getDOMNode().scrollTop=0),i.searchPhotoListViews[t.listId]=n,o.one(".loader").addClass("loaded"),i.set("selected",null),e.fire("photoSelector:unselected")})},function(e){n.error("Error getting view",{err:e})})},activate:function(){var t=this.get("container"),n,r=this.get("defaultSelected");return this.registerEventHandler(e.on("photoSelector:subviewEvent",this.handleSubviewEvent,this)),this.registerEventHandler(t.on("click",this.handleClick,this)),this.get("hasUploadCapabilities")&&this.registerEventHandler(t.one(".file-select").on("change",this.handleFileSelect,this)),this.registerEventHandler(e.on("photoSelector:subviewEvent",this.handleSubviewEvent,this)),r?(r.type==="marketplace"&&(r.id===0||r.id==="0"?n={registryName:"marketplace-creativeCommons-photos-models",modelIdOrAttributes:1,collectionAttributeName:"photos"}:n={registryName:"marketplace-category-photos-models",modelIdOrAttributes:r.id,collectionAttributeName:"photos"},this.toggleSelector(),this.loadPhotoList(n),this.toggleTitleBar(r.title,"marketplace")),r.type==="group"?(n={registryName:"group-pool-models",modelIdOrAttributes:this.get("groupId")+"-public",collectionAttributeName:"photoPageList"},this.publicOnlyGroups&&(n.fetchParams={privacyFilter:1},n.modelIdOrAttributes+="-public"),this.toggleGroupSelector(),this.loadGroupPhotoList(n),this.toggleTitleBar(r.title,"group")):(n={registryName:"set-models",modelIdOrAttributes:r.id,collectionAttributeName:"photoPageList"},this.loadPhotoList(n),this.toggleTitleBar(r.title,"set"))):this.get("photostreamModel").getValue("totalItems")===0?this.toggleUploader():(n={registryName:"photostream-models",modelIdOrAttributes:this.appContext.getViewer().nsid,collectionAttributeName:"photoPageList"},this.loadPhotoList(n,"photostream")),this},toggleUploader:function(){this.get("container").one(".photo-selector-photos-wrapper").addClass("is-hiding"),this.get("container").one(".marketplace-category-wrapper").addClass("is-hiding"),this.photoListView&&this.get("container").one(".photo-selector-photos-container").empty().append(this.templates("flickr-balls")({})),this.get("container").one(".photo-selector-search-lists-wrapper").addClass("is-hiding"),this.get("container").one(".photo-selector-upload").removeClass("is-hiding"),this.get("groupId")&&this.get("container").one(".group-photo-selector-photos-wrapper").addClass("is-hiding")},toggleSelector:function(){this.get("container").one(".photo-selector-upload").addClass("is-hiding"),this.get("container").one(".marketplace-category-wrapper").addClass("is-hiding"),this.get("container").one(".photo-selector-search-lists-wrapper").addClass("is-hiding"),this.get("groupId")&&this.get("container").one(".group-photo-selector-photos-wrapper").addClass("is-hiding"),this.get("container").one(".photo-selector-photos-wrapper").removeClass("is-hiding")},toggleMarketplaceCategorySelector:function(){this.get("container").one(".photo-selector-upload").addClass("is-hiding"),this.get("container").one(".photo-selector-photos-wrapper").addClass("is-hiding"),this.photoListView&&this.get("container").one(".photo-selector-photos-container").empty().append(this.templates("flickr-balls")({})),this.get("container").one(".photo-selector-search-lists-wrapper").addClass("is-hiding"),this.get("container").one(".marketplace-category-wrapper").removeClass("is-hiding"),this.get("groupId")&&this.get("container").one(".group-photo-selector-photos-wrapper").addClass("is-hiding")},toggleSearchListsSelector:function(){this.get("container").one(".photo-selector-upload").addClass("is-hiding"),this.get("container").one(".photo-selector-photos-wrapper").addClass("is-hiding"),this.photoListView&&this.get("container").one(".photo-selector-photos-container").empty().append(this.templates("flickr-balls")({})),this.get("container").one(".marketplace-category-wrapper").addClass("is-hiding"),this.get("container").one(".photo-selector-search-lists-wrapper").removeClass("is-hiding"),this.get("groupId")&&this.get("container").one(".group-photo-selector-photos-wrapper").addClass("is-hiding")},toggleGroupSelector:function(){var e=this.get("container").one(".photo-selector-upload");e&&e.addClass("is-hiding"),this.get("container").one(".photo-selector-photos-wrapper").addClass("is-hiding"),this.photoListView&&this.get("groupId")&&this.get("container").one(".group-photo-selector-photos-wrapper").empty().append(this.templates("flickr-balls")({})),this.get("container").one(".marketplace-category-wrapper").addClass("is-hiding"),this.get("container").one(".photo-selector-search-lists-wrapper").addClass("is-hiding"),this.get("groupId")&&this
.get("container").one(".group-photo-selector-photos-wrapper").removeClass("is-hiding")},toggleTitleBar:function(t,n,r){var i=this.get("container"),s=i.one(".photo-selector-title-bar"),o=s.one(".back-to-list"),u="";typeof r=="undefined"&&(r=!0),n==="search"&&(t='"'+t+'"'),n==="marketplace"?u=this.intlMessage({intlName:"common.PHOTO_SELECTOR_BACK_TO_CATEGORY_LIST"}):n==="set"?u=this.intlMessage({intlName:"common.PHOTO_SELECTOR_BACK_TO_ALBUM_LIST"}):n==="search"&&(u=this.intlMessage({intlName:"common.PHOTO_SELECTOR_BACK_TO_SEARCH_LIST"})),r?o.removeClass("hidden"):o.addClass("hidden"),o.set("text",u),s.one(".title").set("text",e.Handlebars.helpers.truncate(t,120)),s.removeClass("hidden"),i.one(".photo-selector-photos-wrapper").addClass("showing-title"),i.one(".photo-selector-search-lists-wrapper").addClass("showing-title"),i.one(".marketplace-category-wrapper").addClass("showing-title"),this.get("groupId")&&i.one(".group-photo-selector-photos-wrapper").addClass("showing-title")},hideTitleBar:function(){var e=this.get("container"),t=e.one(".photo-selector-title-bar");t.addClass("hidden"),e.one(".photo-selector-photos-wrapper").removeClass("showing-title"),e.one(".marketplace-category-wrapper").removeClass("showing-title"),this.get("groupId")&&e.one(".group-photo-selector-photos-wrapper").removeClass("showing-title")},onParentViewEvent:function(t,n){var r=n[1],i,s,o={},u=this.get("searchable"),a;n[0]==="navigation"?(i=r.target._node.dataset.value,i==="upload"?(this.get("hasUploadCapabilities")&&this.toggleUploader(),this.get("fileDragDrop")?this.get("fileDragDrop").reset():(this.set("fileDragDrop",new e.HtmlFileDragDrop({dropZone:".photo-selector-upload > .drop-zone"})),this.get("fileDragDrop").on("drop",this.handleFileDrop,this))):(this.get("hasUploadCapabilities")&&this.toggleSelector(),i==="marketplace"?this.toggleMarketplaceCategorySelector():i==="group"?(s={registryName:"group-pool-models",modelIdOrAttributes:this.get("groupId"),collectionAttributeName:"photoPageList"},this.publicOnlyGroups&&(s.fetchParams={privacyFilter:1},s.modelIdOrAttributes+="-public"),this.toggleGroupSelector(),this.loadGroupPhotoList(s)):i==="photostream"?(s={registryName:"photostream-models",modelIdOrAttributes:this.appContext.getViewer().nsid,collectionAttributeName:"photoPageList"},this.loadPhotoList(s)):i==="sets"&&(s={registryName:"sets-models",modelIdOrAttributes:this.appContext.getViewer().nsid,collectionAttributeName:"albumsList"},this.loadSetsPhotoList(s)),this.hideTitleBar())):n[0]==="search"&&(a=new e.SearchUrl(r.apiParams,this.appContext),this.toggleSearchListsSelector(),u.yours&&(this.searchUrlYourPhotos=new e.SearchUrl(r.apiParams,this.appContext),this.searchUrlYourPhotos.setAPIParam("user_id",this.appContext.getViewer().nsid),!u.contacts&&!u.everyone?(this.toggleSelector(),s={registryName:"search-photos-lite-models",modelIdOrAttributes:this.searchUrlYourPhotos.getId(),collectionAttributeName:"photos",fetchParams:{apiParams:this.searchUrlYourPhotos.getAPIParams(),additionalExtras:["o_dims","is_marketplace_printable","has_invalid_colorspace_for_print"]}},this.loadPhotoList(s,!0)):(o.listId="yours",o.photoListContainerSelector=".photo-selector-search-list-yours .photo-selector-search-list-container",o.parentContainerSelector=".photo-selector-search-list-yours",o.maxNumRows=1,o.alwaysDisplayOrphans=!0,o.searchUrl=this.searchUrlYourPhotos,o.modelParams={registryName:"search-photos-lite-models",modelIdOrAttributes:this.searchUrlYourPhotos.getId(),collectionAttributeName:"photos",fetchParams:{apiParams:this.searchUrlYourPhotos.getAPIParams()}},this.loadSearchPhotoList(o))),u.contacts&&(this.searchUrlContactsPhotos=new e.SearchUrl(r.apiParams,this.appContext),this.searchUrlContactsPhotos.setAPIParam("user_id",this.appContext.getViewer().nsid),this.searchUrlContactsPhotos.setAPIParam("contacts","all"),o.listId="contacts",o.photoListContainerSelector=".photo-selector-search-list-contacts .photo-selector-search-list-container",o.parentContainerSelector=".photo-selector-search-list-contacts",o.maxNumRows=1,o.alwaysDisplayOrphans=!0,o.searchUrl=this.searchUrlContactsPhotos,o.modelParams={registryName:"search-photos-lite-models",modelIdOrAttributes:this.searchUrlContactsPhotos.getId(),collectionAttributeName:"photos",fetchParams:{apiParams:this.searchUrlContactsPhotos.getAPIParams()}},this.loadSearchPhotoList(o)),u.everyone&&(this.searchUrlEveryonePhotos=new e.SearchUrl(r.apiParams,this.appContext),o.listId="everyone",o.photoListContainerSelector=".photo-selector-search-list-everyone .photo-selector-search-list-container",o.parentContainerSelector=".photo-selector-search-list-everyone",o.maxNumRows=1,o.alwaysDisplayOrphans=!0,o.searchUrl=this.searchUrlEveryonePhotos,o.modelParams={registryName:"search-photos-lite-models",modelIdOrAttributes:r.id,collectionAttributeName:"photos",fetchParams:{apiParams:this.searchUrlEveryonePhotos.getAPIParams()}},this.loadSearchPhotoList(o)),u.marketplace,this.toggleTitleBar(a.getAPIParams().text,"search",!1))},handleSubviewEvent:function(t){var n,r,i;if(t.eventName==="selectPhotoFromPhotoList")return n={photoModel:this.appContext.getModel("photo-models",t.id)},(new e.FlickrPromise(n)).then(function(t){t.photoModel.isOwner&&this.set("photoSource",this.get("photoSourceOwnImage")),e.fire("photoSelector:selected",{hasWarning:!1,photoId:t.photoModel.id}),this.set("selected",t.photoModel.id)}.bind(this));t.eventName==="selectSetFromPhotoList"?(r={registryName:"set-models",modelIdOrAttributes:t.id,collectionAttributeName:"photoPageList"},this.loadPhotoList(r),this.toggleTitleBar(t.title,"set")):t.details&&t.details[0]==="viewEntireSearchList"&&(r={registryName:"search-photos-lite-models",modelIdOrAttributes:t.details[1].searchUrl.getId(),collectionAttributeName:"photos",fetchParams:{apiParams:t.details[1].searchUrl.getAPIParams()}},this.toggleSelector(),this.loadPhotoList(r),i="search.YOUR_PHOTOS",t.details[1].list==="contacts"?i="search.FROM_YOUR_CONTACTS":t.details[1].list==="everyone"&&
(i="search.EVERYONES_PHOTOS"),i=this.intlMessage({intlName:i}),this.toggleTitleBar(i+": "+t.details[1].searchUrl.getAPIParams().text,"search"))},handleClick:function(e){var t=e.target,n,r;if(this.isUploading)return;t.hasClass("marketplace-category")||t.hasClass("creative-commons-category")?(n=t.getData("value"),n===this.get("categoryIdCreativeCommons")||n===this.get("categoryIdNasa")?this.set("photoSource",this.get("photoSourceCreativeCommons")):this.set("photoSource",this.get("photoSourceMarketplace")),n===0||n==="0"?r={registryName:"marketplace-creativeCommons-photos-models",modelIdOrAttributes:1,collectionAttributeName:"photos"}:r={registryName:"marketplace-category-photos-models",modelIdOrAttributes:n,collectionAttributeName:"photos"},this.toggleSelector(),this.loadPhotoList(r),this.toggleTitleBar(t.getData("title"),"marketplace")):t.hasClass("back-to-list")?this.fire("subviewViewEvent","backToList"):t.hasClass("simulate-file-select")&&(e.halt(),this.get("container").one(".file-select").set("value",""),this.get("container").one(".file-select").getDOMNode().click())},handleSelectPhoto:function(t){var n;n={photoModel:this.appContext.getModel("photo-models",t.getData("photo-id"))};if(t.hasClass("invalid"))return;return this.set("photoSource",this.get("photoSourceOwnImage")),(new e.FlickrPromise(n)).then(function(t){e.fire("photoSelector:selected",{hasWarning:!1,photoId:t.photoModel.id}),this.set("selected",t.photoModel.id)}.bind(this))},handlePhotoSetSelector:function(e){var t;this.get("hasUploadCapabilities")&&this.toggleSelector(),t={registryName:"set-models",modelIdOrAttributes:e,collectionAttributeName:"photoPageList"},this.loadPhotoList(t)},handlePhotoUploaded:function(e){this.appContext.getModelRegistry("photostream-models").then(function(t){t.attributeSearch({normalizedId:this.appContext.getViewer().nsid},!0).forEach(function(e){t.remove(e)}),this.set("selected",e.id),this.fire("actionClick",e),this.resetUploader()}.bind(this),function(e){this.appContext.err(e)}.bind(this))},handleFileSelect:function(e){var t;t=e.target.getDOMNode().files[0],t&&t.name&&this.uploadFile(t)},pollTicket:function(t){var n;if(!this.uploadTimer)this.uploadTimer=e.moment();else{n=e.moment().diff(this.uploadTimer,"seconds");if(n>this.get("maxUploadTimeAllowed"))return this.showUploadError("GENERIC")}this.appContext.callAPI("flickr.photos.upload.checkTickets",{tickets:t}).then(function(e){var n;e&&e.stat&&(e.stat!=="ok"&&this.showUploadError("GENERIC"),e.uploader&&e.uploader.ticket instanceof Array&&(n=e.uploader.ticket[0],n&&n.id===t&&(n.complete===1?this.appContext.getModel("photo-models",n.photoid).then(this.handlePhotoUploaded.bind(this),function(e){this.showUploadError("GENERIC")}):n.complete===2?this.showUploadError("FILE_TYPE"):setTimeout(function(){this.pollTicket(t)}.bind(this),1e3))))}.bind(this),function(e){this.showUploadError("GENERIC")}.bind(this))},resetUploader:function(){this.clearUploadError(),this.get("container").one(".drop-zone").removeClass("uploading"),this.get("container").removeClass("uploading"),this.isUploading=!1,this.uploadTimer=undefined},uploadFile:function(t){var r=new FormData,i,s=e.config.flickr.api.hostname_client_upload,o,u;this.clearUploadError(),this.get("container").one(".drop-zone").addClass("uploading"),this.get("container").addClass("uploading"),this.isUploading=!0,r.append("api_key",e.config.flickr.api.site_key),r.append("csrf",e.config.flickr.csrf.token),r.append("photo",t,t.name),r.append("async","1"),r.append("is_public","0"),r.append("is_friend","0"),r.append("is_family","0"),r.append("content_type","1"),i=this._imgFileXhr=new XMLHttpRequest,i.open("POST",s,!0),i.withCredentials=!0,o=function(e){var t=typeof e=="object"?e.target.statusText:e+"";n.error("Error during upload",{statusText:t}),this.resetUploader(),this.showUploadError("GENERIC")},u=function(t){var n,r,i,s;try{s=e.one(t.currentTarget.responseXML),r=s.one("rsp").getAttribute("stat")}catch(u){r="",n=""}return r!=="ok"?o((r||"empty")+": "+(n||"no message")):(i=s.one("ticketid").get("text"),this.pollTicket(i))},i.addEventListener("load",u.bind(this)),i.addEventListener("error",o.bind(this)),i.send(r)},clearUploadError:function(){this.get("container").one(".upload-error").setHTML("")},showUploadError:function(e){this.resetUploader(),this.get("container").one(".upload-error").setHTML(this.intlMessage({intlName:this.get("errorMessages")[e]})),this.get("fileDragDrop").showError()},handleFileDrop:function(e){if(this.isUploading)return;e instanceof Error?this.showUploadError(e.message):this.uploadFile(e)},destructor:function(){this.photoListView&&this.photoListView.destroy()}},{ATTRS:{maxUploadTimeAllowed:{readOnly:!0,value:20},errorMessages:{readOnly:!0,value:{GENERIC:"common.PHOTO_SELECTOR_ERROR_MESSAGE_GENERIC",FILE_TYPE:"common.PHOTO_SELECTOR_ERROR_MESSAGE_FILE_TYPE",FILE_SIZE:"common.PHOTO_SELECTOR_ERROR_MESSAGE_FILE_SIZE",FILE_COUNT:"common.PHOTO_SELECTOR_ERROR_MESSAGE_FILE_COUNT",LOW_QUALITY:"common.PHOTO_SELECTOR_ERROR_MESSAGE_LOW_QUALITY",COLOR_SPACE:"common.PHOTO_SELECTOR_ERROR_MESSAGE_COLOR_SPACE"}},categoryIdCreativeCommons:{readOnly:!0,value:"101"},categoryIdNasa:{readOnly:!0,value:"102"},categoryIdAbstract:{readOnly:!0,value:"1"},photoSourceOwnImage:{readOnly:!0,value:1},photoSourceCreativeCommons:{readOnly:!0,value:2},photoSourceMarketplace:{readOnly:!0,value:3},enableMarketplaceProducts:{value:!0,setter:function(e){return e}},isCreativeCommonsWallartEnabled:{value:!1,setter:function(e){return this.appContext.flipper.isFlipped("creative-commons-wallart")?e:!1}},hasUploadCapabilities:{value:!0},photoListViewName:{value:"photo-selector-photolist-view"},limitedRowsPhotoListViewName:{value:"photo-selector-limited-rows-photolist-view"},searchable:{value:{yours:!0,contacts:!0,everyone:!0,marketplace:!1}},interactionViewName:{value:"photo-selector-photolist-interaction-view"},setsInteractionViewName:{value:"photo-selector-sets-photolist-interaction-view"},itemFilterFunction:{value:function(e){return!e
.getValue("isVideo")}},defaultSelected:{value:!1},selected:{},groupId:{}}})},"@VERSION@",{requires:["flickr-view","flickr-promise","flickr-api","html-file-dragdrop","hermes-template-photo-selector","util-css","flickrui-css","fluid-balls-css","photo-selector-css","photo-selector-photolist-view","photo-selector-limited-rows-photolist-view","photo-selector-photolist-interaction-view","photo-selector-sets-photolist-interaction-view"],optional:["search-photos-lite-models"],langBundles:["common","wallart","search","groups"]});
YUI.add("hermes-lang-wallart",function(e,t){e.Intl.add("hermes/wallart","en-US",{WALL_ART:["Wall Art"],YOU_CANCELLED_THIS_ITEM_ON_DATE:["You cancelled this item order on ",{type:"date",valueName:"date",format:"monthYear"}],YOU_ORDERED_THIS_ITEM_ON_DATE:["You ordered this item on ",{type:"date",valueName:"date",format:"monthYear"}],RETURN_TO_YOUR_ORDER_HISTORY:["Return to your order history"],SELECT_A_PHOTO:["Select a photo"],SELECT_PRODUCT:["Select product"],PHOTO_MOUNT:["Photo Mount"],CANVAS:["Canvas"],CANVAS_WRAP:["Canvas Wrap"],PREMIUM_LUSTRE:["Premium Lustre"],GLOSSY:["Glossy"],MATTE:["Matte"],SIZE:["Size"],CHECKOUT:["Checkout"],REORDER:["Reorder"],TOTAL:["Total"],UPLOAD:["Upload"],CURATED_COLLECTIONS:["Curated Collections"],CREATIVE_COMMONS:["Creative Commons"],NASA:["NASA"],ABSTRACT:["Abstract"],ANIMALS:["Animals"],PATTERNS:["Patterns"],FOOD:["Food"],LANDSCAPES:["Landscapes"],TRAVEL:["Travel"],MY_ALBUMS:["My Albums"],PRODUCT_DROPUP_CANVAS:['Artist-grade canvas wrapped around 1.25" wood frame'],PRODUCT_DROPUP_MOUNTED:['Archival photo paper finished with 1" wood-textured edge'],MATERIAL_DROPUP_LUSTRE:["Professional Crystal Archive - Premium Lustre"],MATERIAL_DROPUP_GLOSSY:["Professional Crystal Archive - Glossy"],MATERIAL_DROPUP_MATTE:["Professional Crystal Archive - Matte"],SIZES_MODAL_SIZES_NOT_AVAILABLE:["Some sizes not available due to the resolution of the photo. Learn More."],MOUNTED_SAFE_AREA:["The area outside of the solid-line will not be printed. <br>Inside the line is the safe area."],CANVAS_SAFE_AREA:["The area outside of the dotted-line will be printed on the wrap. <br>Inside the line will be printed on the front."],SAVING:["Saving..."],SAVED:["All changes saved"],WITH_CODE:["with code:"],FREE_SHIPPING_WITH_CODE:["Free shipping with code:"],PRODUCT_DESCRIPTION_CANVAS_PART_1_8X10:['8" x 10" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_10X8:['10" x 8" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_12X12:['12" x 12" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_11X14:['11" x 14" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_14X11:['14" x 11" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_16X20:['16" x 20" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_20X16:['20" x 16" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_20X24:['20" x 24" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_24X20:['24" x 20" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_20X30:['20" x 30" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_1_30X20:['30" x 20" gallery wrap'],PRODUCT_DESCRIPTION_CANVAS_PART_2:['1.25" stretcher bars<br>Impact resistant frame<br>Includes hardware to hang'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_8X10:['8" x 10" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_10X8:['10" x 8" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_12X12:['12" x 12" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_11X14:['11" x 14" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_14X11:['14" x 11" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_16X20:['16" x 20" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_20X16:['20" x 16" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_20X30:['20" x 30" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_1_30X20:['30" x 20" mounted print'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE:['Matte finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY:['Glossy finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE:['Premium lustre finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE_KICKSTAND:['Matte finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging and kickstand for table-top display'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY_KICKSTAND:['Glossy finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging and kickstand for table-top display'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE_KICKSTAND:['Premium lustre finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging and kickstand for table-top display'],PHOTO_TOO_SMALL_IN_SELECTED_SIZE:['This photo is too small to print in your selected size. We\'ll automatically find the next best size for you. <a href="http://help.yahoo.com/kb/index?page=content&y=PROD_FLICKR&locale=en_US&id=SLN22567">Learn more.</a>'],BAD_SIZES:['Some sizes not available due to the resolution of the photo. <a target="_blank" href="http://help.yahoo.com/kb/index?page=content&y=PROD_FLICKR&locale=en_US&id=SLN22567">Learn More</a>'],NOT_AVAILABLE:["Not available due to photo resolution"],UPLOADR_ERROR_MESSAGE_GENERIC:["There was a problem uploading your photo. Please try again."],UPLOADR_ERROR_MESSAGE_FILE_TYPE:["Looks like this photo has an invalid file type. Upload a photo that is either a PNG or JPG."],UPLOADR_ERROR_MESSAGE_FILE_SIZE:["Looks like this photo is too large to upload. The largest photo size we can upload is 250 MB."],UPLOADR_ERROR_MESSAGE_FILE_COUNT:["Select only one photo to upload."],UPLOADR_ERROR_MESSAGE_LOW_QUALITY:['Looks like this photo doesn\'t meet the minimum requirements to get printed. Please choose a photo that\'s at least 975 &times; 825 pixels. Learn more about <a href="http://help.yahoo.com/kb/index?page=content&y=PROD_FLICKR&locale=en_US&id=SLN22567" target="_blank">requirements</a> for print products.'],UPLOADR_ERROR_MESSAGE_COLOR_SPACE:['Sorry, we cannot print photos with a CMYK or ProPhoto RGB colorspace. We recommend photos with an sRGB color space. <a href="https://help.yahoo.com/kb/flickr/creations-faq-sln22216.html?impressions=true#cont33" target="_blank">Learn more</a>.'],DRAG_DROP_TO_UPLOAD:['Drag and drop your photo to upload or <a href="#" class="simulate-file-select">browse</a>.'],PHOTOS_UPLOADED_AS_PRIVATE:['Photos uploaded here will be added to your <a href="/me/">Photostream</a> as private.'],LOW_QUALITY_ZOOM_HANDLE_TOOLTIP_CANVAS:["At this zoom level, your photo will print at a low quality. Please zoom out to purchase."
],LOW_QUALITY_ZOOM_HANDLE_TOOLTIP_MOUNTED:["At this zoom level, your photo will print at a low quality. Please zoom out to purchase."],INITIAL_DIALOG_CANVAS_DISABLED:["Canvas Wrap is not available for this photo due to its low resolution. Canvas Wrap requires a minimum 975px x 825px."],INITIAL_DIALOG_MOUNTED_DISABLED:["Photo Mount is not available for this photo due to its low resolution. Photo Mount requires a minimum 1000px x 800px."],GO_BACK:["Go back"],PHOTO_NOT_LARGE_ENOUGH_TO_ROTATE:["This photo is not large enough to rotate into a different orientation."],CHANGE_SIZE:["Change size"],CHANGE_PHOTO:["Change photo"],CREATIONS:["Creations"],VIEW_ORDER_HISTORY:["View order history"],COMPLETED:["Completed"],IN_PROGRESS:["In progress"],CREATE_NEW:["Create new"],CREATIONS_EMPTY_WALLART:["No Wall Art to show"],CREATIONS_EMPTY_BOOKS:["No Photo Books to show"],CREATIONS_EMPTY_TERTIARY:['We\'ll display in progress and completed creations here.<br>Learn more about <a href="/create" title="">Wall Art</a> and <a href="/create" title="">Photo Books</a>.'],CREATIONS_NOT_ABLE_DELETE:["We were not able to delete this creation. Please try again later."],PHOTO_FOR_WALLART_DELETED:["The photo for this wall art was deleted"],DELETE_THIS_WALLART:["Delete this wall art"],REORDER_THIS_WALLART:["Reorder this wall art"],EDIT_THIS_WALLART:["Edit this wall art"],CHANGE_PAPER:["Change paper"],MATERIAL_DROPUP_LUSTRE_NEW:['Lustre\'s pearl-like finish gives your photo a "true-to-life" look. It provides the color saturation of glossy but the fingerprint resistance of matte.'],MATERIAL_DROPUP_GLOSSY_NEW:["A sleek, glossy finish with high-contrast appearance so your photos appear crisp and sharp. Great for highly reflective photos of water, metal or sky."],MATERIAL_DROPUP_MATTE_NEW:["An elegant, matte finish with lower contrast to enhance the texture of your photo. Resists fingerprints and is great for black and white photos."],ON_SALE:["On Sale"],PRODUCT_DESCRIPTION_CANVAS_PART_2_PREVIEW:['<span>1.25" stretcher bars</span><span>Impact resistant frame</span><span>Includes hardware to hang</span>'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE_PREVIEW:['<span>Matte finish</span><span>1" wood-textured edge</span><span>Pre-drilled holes for easy hanging</span>'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY_PREVIEW:['<span>Glossy finish</span><span>1" wood-textured edge</span><span>Pre-drilled holes for easy hanging</span>'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE_PREVIEW:['<span>Premium lustre finish</span><span>1" wood-textured edge</span><span>Pre-drilled holes for easy hanging</span>'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_MATTE_KICKSTAND_PREVIEW:['<span>Matte finish</span><span>1" wood-textured edge</span><span>Pre-drilled holes for easy hanging and kickstand for table-top display</span>'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_GLOSSY_KICKSTAND_PREVIEW:['<span>Glossy finish</span><span>1" wood-textured edge</span><span>Pre-drilled holes for easy hanging and kickstand for table-top display</span>'],PRODUCT_DESCRIPTION_MOUNTED_PART_2_LUSTRE_KICKSTAND_PREVIEW:['<span>Premium lustre finish</span><span>1" wood-textured edge</span><span>Pre-drilled holes for easy hanging and kickstand for table-top display</span>'],PHOTO_BOOK:["Photo Book"],GLOSSY_HARDCOVER_BOOK_PREMIUM_LUSTRE_PAPER:['11" x 8.5" glossy hardcover book with premium lustre paper']})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-template-fluid-modal-nav-bar",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n			",i=n.unless.call(e,e.disabled,{hash:{},inverse:f.noop,fn:f.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="\n		",r}function c(e,t){var r="",i;r+='\n			<li data-id="',(i=n.id)?i=i.call(e,{hash:{},data:t}):(i=e.id,i=typeof i===u?i.apply(e):i),r+=a(i)+'" data-value="',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===u?i.apply(e):i),r+=a(i)+'" class="link ',i=n["if"].call(e,e.selected,{hash:{},inverse:f.noop,fn:f.program(3,h,t),data:t});if(i||i===0)r+=i;r+=" ",i=n["if"].call(e,e.hiddenByDefault,{hash:{},inverse:f.noop,fn:f.program(5,p,t),data:t});if(i||i===0)r+=i;return r+='"><a data-value="',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===u?i.apply(e):i),r+=a(i)+'">',(i=n.name)?i=i.call(e,{hash:{},data:t}):(i=e.name,i=typeof i===u?i.apply(e):i),r+=a(i)+"</a></li>\n			",r}function h(e,t){return"selected"}function p(e,t){return"hidden"}function d(e,t){return'\n			<form action="/search" method="get" role="search">\n				<input type="text" name="text" value="" class="search-field" autocomplete="off" aria-label="Search" role="textbox">\n				<input type="submit" class="search-icon" tabindex="-1" aria-label="Search" role="button">\n			</form>\n		'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="fluid-modal-nav-bar">\n	<div class="fluid-modal-nav-content">\n		<ul class="links">\n		',o=n.each.call(t,t.links,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n		</ul>\n		",o=n["if"].call(t,t.enableSearch,{hash:{},inverse:f.noop,fn:f.program(7,d,i),data:i});if(o||o===0)s+=o;return s+="\n	</div>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/fluid-modal-nav-bar",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("fluid-modal-nav-bar-view",function(e){"use strict";var t;t={css:{nav:".fluid-modal-nav-bar",navContent:".fluid-modal-nav-content",links:".links",link:".link"},options:{}},e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this},loadState:function(){return this},buildContainer:function(){var e;return e={links:this.get("links"),enableSearch:this.get("enableSearch"),enableMarketplaceProductsSearch:this.get("enableMarketplaceProductsSearch")},this.setContainerHTML(this.templates("fluid-modal-nav-bar")(e)),this},activate:function(){var e=this.get("container"),t=this;return this.registerEventHandler(e.on("click",this.handleClick.bind(this))),this.get("links").forEach(function(n){n.selected&&t.set("currentSelection",e.one('.link[data-id="'+n.id+'"]'))}),this},deselectAll:function(){var e=this.get("container"),n=e.one(t.css.nav),r=n.one(t.css.navContent),i=r.one(t.css.links);i.all(t.css.link).removeClass("selected")},handleClick:function(t){t.halt();var n=t.target,r=n.get("parentNode"),i=this.get("container"),s,o={},u=this.appContext.getViewer().nsid;n.getDOMNode().tagName.toLowerCase()==="a"?(this.deselectAll(),r.addClass("selected"),this.set("currentSelection",r),i.one(".search-field").getDOMNode().value="",this.fire("subviewViewEvent","navigation",t)):n.hasClass("link")?(this.deselectAll(),n.addClass("selected"),this.set("currentSelection",n),i.one(".search-field").getDOMNode().value="",this.fire("subviewViewEvent","navigation",t)):this.get("enableSearch")&&(s=i.one(".search-field").getDOMNode(),n.getDOMNode().type==="submit"&&(o.apiParams={},o.apiParams[e.AttributeHelpers.coerceString(s.name)]=s.value,o.id=e.SearchHelper.generateQueryString(o.apiParams)||e.guid(),o.viewerNsid=u,this.fire("subviewViewEvent","search",o),this.deselectAll(),this.set("currentSelection",{type:"search",modelParams:o})))},onParentViewEvent:function(t,n){var r=this.get("currentSelection");n[0]==="backToList"&&(r instanceof e.Node?this.get("currentSelection").getDOMNode().click():r.type==="search"&&this.fire("subviewViewEvent","search",r.modelParams))}},{ATTRS:{links:{value:[],validator:function(t){return e.Lang.isArray(t)}},currentSelection:{value:null},enableSearch:{value:!0,validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},enableMarketplaceProductsSearch:{value:!1,validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}}}})},"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-css","hermes-template-fluid-modal-nav-bar","attribute-helpers","search-helper"],langBundles:["common","wallart"],optional:["person-models","photo-models"]});
YUI.add("fluid-coverphoto-editor",function(e){"use strict";var t=768,n=2048,r;r={dragging:{mouseDownY:0,previousY:0},potential:{y:0,height:0,width:0,url:"",id:0,aspectRatio:0},original:{width:0,height:0,url:""}},e.FluidCoverPhotoEditor=function(e){this.coverPhotoElement=e,r.original.url=e.getStyle("backgroundImage")},e.FluidCoverPhotoEditor.prototype.loadCoverPhoto=function(t){var n=new Image,i=this,s,o,u;return new e.Promise(function(e,a){n.onload=function(){u=i._determineBoundaries(r.potential.height,r.potential.width),i.coverPhotoElement.setStyles({backgroundImage:"url("+n.src+")",backgroundPosition:"50% "+u.min*-1+"px"}),i.coverPhotoElement.addClass("editing"),i.setupEditorHandlers(),e()},r.potential.id=t.id,o=t.getValue("descendingSizes")[0],s=t.getValue("descendingSizes")[1],r.potential.width=s.width,r.potential.height=s.height,r.potential.url=s.url,r.original.width=o.width,r.original.height=o.height,r.potential.aspectRatio=t.getValue("aspectRatio"),n.src=s.url})},e.FluidCoverPhotoEditor.prototype._convertYPositionForApi=function(e,i){var s=parseInt(this.coverPhotoElement.get("offsetHeight"),10),o=parseInt(this.coverPhotoElement.get("offsetWidth"),10),u,a,f,l;return r.potential.aspectRatio!==r.original.width/r.original.height&&(i=r.original.height),u=Math.abs(e)+s/2,a=u*n/o,f=a-t/2,l=f*i/n,l},e.FluidCoverPhotoEditor.prototype._determineBoundaries=function(e,r){var i=parseInt(this.coverPhotoElement.get("offsetWidth"),10),s=parseInt(this.coverPhotoElement.get("offsetHeight"),10),o,u,a,f,l,c;return o=i*e/r,u=t/2,f=u*i/n,a=f-s/2,l=o-a,c=l-s,{min:a,max:c}},e.FluidCoverPhotoEditor.prototype.setupEditorHandlers=function(){var t=this,n=this._determineBoundaries(r.potential.height,r.potential.width);e.one(e.config.win.document.documentElement).addClass("disable-text-select"),this.coverPhotoElement.on("mousedown",function(e){e.halt();var n=t.coverPhotoElement.getStyle("backgroundPosition").split(" "),i=n.length===2?parseInt(n[1],10):0;r.dragging.mouseDownY=e.pageY,r.dragging.previousY=i,r.dragging.startDrag=!0,t.coverPhotoElement.addClass("grabbing")}),this.coverPhotoElement.on("mouseup",function(){r.dragging.startDrag=!1,t.coverPhotoElement.removeClass("grabbing")}),this.coverPhotoElement.on("mouseout",function(){r.dragging.startDrag=!1,t.coverPhotoElement.removeClass("grabbing")}),this.coverPhotoElement.on("mousemove",function(e){e.halt();if(!r.dragging.startDrag)return;var i=r.dragging.mouseDownY-e.pageY,s=r.dragging.previousY-i,o=n.min*-1,u=n.max*-1;s=s>=u?s:u,s=s>o?o:s,r.potential.y=s,t.coverPhotoElement.setStyle("backgroundPosition","50% "+s+"px")})},e.FluidCoverPhotoEditor.prototype.cancelCoverPhotoEditing=function(){this.coverPhotoElement.removeClass("editing"),this.coverPhotoElement.setStyles({backgroundImage:r.original.url,backgroundPosition:"50% 50%"}),this.coverPhotoElement.detachAll(),e.one(e.config.win.document.documentElement).removeClass("disable-text-select")},e.FluidCoverPhotoEditor.prototype.saveCoverPhoto=function(t){var n=this._convertYPositionForApi(r.potential.y,r.original.width),i={photo_id:r.potential.id,y:n},s;t&&(i.group_id=t,s="group"),this.coverPhotoElement.addClass("saving"),e.coverPhotoSaver.save(i,s).then(function(){e.config.win.location.reload()})}},"@VERSION@",{affinity:"",requires:["flickr-promise","event-custom"]});
YUI.add("coverphoto-saver",function(e){"use strict";e.coverPhotoSaver={methods:{photostream:"flickr.coverphoto.setAccountCover",group:"flickr.coverphoto.setGroupCover"},save:function(t,n){var r=e.config.win.appContext,i={group_id:t.group_id,photo_id:t.photo_id,x:Math.abs(t.x||0),y:Math.abs(t.y||0)},s=this.methods[n||"photostream"];return new e.Promise(function(e,t){r.callAPI(s,i).then(function(n){var i=0,s=5,o=2e3,u=function(){r.callAPI("flickr.photos.upload.checkTickets",{tickets:n.coverphoto.ticketId}).then(function(n){var r=n&&n.uploader.ticket[0];i++,r&&r.complete===1?e():i>s?t():setTimeout(u,o)})};n&&n.coverphoto&&n.coverphoto.ticketId&&setTimeout(u,o)},function(e){t(new Error("Cover photo could not be saved."))})})}}},"@VERSION@",{requires:["flickr-promise"]});
