YUI.add("attribute-helpers",function(e){function t(e){if(typeof e=="undefined"||e===null)return!0}function n(n){return t(n)?!0:e.Lang.isString(n)?!0:e.Lang.isNumber(n)?!0:!1}function r(t){return e.Lang.isNumber(t)&&(t=t.toString()),e.Lang.isString(t)?t:undefined}function i(n){return t(n)?!0:[!0,!1].indexOf(n)!==-1?!1:n instanceof Array?!1:(typeof n=="string"&&(n=parseInt(n,10)),typeof n=="object"&&typeof n._d!="undefined"&&(n=n._d),e.moment(n).isValid()?!0:!1)}function s(t){var n=null,r=null;if(e.moment.isMoment(t))return t;if(t&&typeof t=="object"&&t._d){r=e.moment(t),r.isValid()||(r=e.moment(t._d));if(r.isValid())return r}return typeof t=="number"||t===parseInt(t,10).toString()?(n=parseInt(t,10),n.toString().length<=10?r=e.moment(n.toString(),"X"):r=e.moment(n),r):t&&!e.Lang.isBoolean(t)&&(e.moment(new Date(t)).isValid()||e.moment(new Date(t.toString().replace(" ","T"))).isValid())?e.moment(t):undefined}function o(n){return t(n)?!0:(e.Lang.isString(n)&&(n=parseInt(n,10)),e.Lang.isNumber(n)?!0:!1)}function u(t){return e.Lang.isString(t)&&(t=parseInt(t,10)),e.Lang.isNumber(t)?t<0?Math.ceil(t):Math.floor(t):undefined}function a(n){return t(n)?!0:(e.Lang.isString(n)&&(n=parseFloat(n)),e.Lang.isNumber(n)?!0:!1)}function f(t){return e.Lang.isString(t)&&(t=parseFloat(t)),e.Lang.isNumber(t)?t:undefined}function l(n){return t(n)?!0:e.Lang.isBoolean(n)?!0:[0,"0","false"].indexOf(n)>-1?!0:[1,"1","true"].indexOf(n)>-1?!0:!1}function c(e){return[!1,"0",0,"false"].indexOf(e)>-1?!1:[!0,"1",1,"true"].indexOf(e)>-1?!0:undefined}e.AttributeHelpers={validateString:n,coerceString:r,validateInteger:o,coerceInteger:u,validateFloat:a,coerceFloat:f,validateBoolean:l,coerceBoolean:c,validateDate:i,coerceDate:s}},"@VERSION@",{requires:[]});
YUI.add("fluid-overlay-manager-view",function(e){"use strict";var t=0,n=e.Base.create("overlayManager",e.Base,[],{add:function(n){var r=this.get("overlay"),i=n.getAttrs(),s=this;this.get("modals").push(n),r?i.dismissOnOverlayClick&&this.set("dismissOnOverlayClick",!0):(r=e.Node.create(this.get("overlayHTML")),e.one("body").append(r),this.set("overlay",r),t++,this.addOverlayClickHandler(r),this.addOverlayKeyHandler(r),i.dismissOnOverlayClick?this.set("dismissOnOverlayClick",!0):this.set("dismissOnOverlayClick",!1)),this.setOverlayStyle(i),i.dismissOnActionClick&&n.on("actionClick",function(){setTimeout(function(){s.close()},0)}),n.name==="fluid-modal-view"&&n.on("cancelClick",function(){setTimeout(function(){s.close()},0)})},setOverlayStyle:function(e){var t="",n="",r="",i=this.get("overlay");e.hideModalOverlay&&(t="transparent"),e.darkOverlay&&(t="dark-overlay"),e.invisibleOverlay&&(n="invisible"),e.overlayClassList&&(r=e.overlayClassList),i.setAttribute("class",this.get("overlayClass")+" "+r+" "+t+" "+n)},addOverlayClickHandler:function(e){e.getDOMNode().addEventListener("click",this.clickHandler.bind(this))},removeOverlayClickHandler:function(e){e.getDOMNode().removeEventListener("click",this.clickHandler.bind(this))},addOverlayKeyHandler:function(t){e.one("body").getDOMNode().addEventListener("keyup",this.keyHandler.bind(this))},removeOverlayKeyHandler:function(t){e.one("body").getDOMNode().removeEventListener("keyup",this.keyHandler.bind(this))},keyHandler:function(e){e.keyCode===27&&this.clickHandler()},clickHandler:function(){var e=this.get("modals").length-2,t="",n="",r="",i,s=this.get("overlay");this.get("dismissOnOverlayClick")&&(this.set("dismissOnOverlayClick",!1),this.close(),e>-1&&this.get("modals").length>0&&(i=this.get("modals")[e].getAttrs(),i.hideModalOverlay&&(t="transparent"),i.invisibleOverlay&&(n="invisible"),i.overlayClassList&&(r=i.overlayClassList),s.setAttribute("class",this.get("overlayClass")+" "+r+" "+t+" "+n),this.set("dismissOnOverlayClick",i.dismissOnOverlayClick)))},remove:function(e){var t=this.get("modals");if(e.isClosed){var n=t.indexOf(e);n>-1?t.splice(n,1):t.length===1&&(n=0,t.splice(n,1)),this.removeOverlay()}},close:function(){var e=this.get("modals").pop();e&&!e.isClosed&&e.close(),this.removeOverlay()},closeAll:function(){var e=this;this.get("modals").forEach(function(t,n){e.close()})},removeOverlay:function(){var e=this.get("overlay");if(this.get("modals").length===0&&e)this.removeOverlayClickHandler(e),this.removeOverlayKeyHandler(e),e.remove(),this.set("overlay",undefined),t--;else{var n=this.get("modals").length-1;n>-1&&this.setOverlayStyle(this.get("modals")[n].getAttrs())}},alreadyShowingModal:function(e){var t=!1;return e||(e="fluid-modal-view"),this.get("modals").forEach(function(n,r){n.name===e&&(t=!0)}),t}},{ATTRS:{modals:{value:[],validator:function(t){return e.Lang.isArray(t)}},overlayHTML:{},overlayClass:{},overlay:{value:undefined},dismissOnOverlayClick:{value:!0,setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},validator:function(t){return e.Lang.isBoolean(t)}}}});e.OverlayManager={DroparoundOverlay:new n({overlayHTML:'<div class="fluid-droparound-overlay"></div>',overlayClass:"fluid-droparound-overlay"}),ModalOverlay:new n({overlayHTML:'<div class="fluid-modal-overlay"><div class="balls"></div></div>',overlayClass:"fluid-modal-overlay"}),SignupInterstitialOverlay:new n({overlayHTML:'<div class="signup-interstitial-overlay interstitial-fade"></div>',overlayClass:"signup-interstitial-overlay interstitial-fade"}),ChalkboardOverlay:new n({overlayHTML:'<div class="fluid-chalkboard-overlay"></div>',overlayClass:"fluid-chalkboard-overlay"}),hasOverlay:function(){return t>0}}},"@VERSION@",{requires:["base","flickr-view","attribute-helpers","fluid-css","fluid-balls-css"],optional:[],langBundles:[],optionalRequires:["fluid"]});
YUI.add("fluid-droparound-view",function(e,t){"use strict";var n=require("lib/flog")(t),r,i;r={css:{destinationContainer:"body",subviewContent:".content.subview",menuContent:".content.menu",droparoundContainer:".droparound",droparoundContent:".body .content",droparrow:".droparrow"},options:{}},i={supportsTransform:!1,droparound:{height:0,width:0}},e.namespace("Views").FluidDroparound=e.FlickrView.create(this.name,e.FlickrView,[],{initializer:function(e){this.set("isActiveViewAgnostic",!0)},buildContainer:function(){return!this.get("textMessage")&&!this.get("htmlMessage")&&!this.get("subview")&&!this.get("menuItems")?(n.warn("requires a `textMessage`, `htmlMessage`, `subview`, or `menuItems`."),this):(this.get("menuItems")&&this.set("menuItems",this.get("menuItems").filter(function(e){return!e.hidden})),this.setContainerHTML(this.templates("fluid-droparound")({textMessage:this.get("textMessage"),htmlMessage:this.get("message")?this.get("message"):this.get("htmlMessage"),subview:!!this.get("subview"),menuItems:this.get("menuItems"),multiSelect:this.get("multiSelect"),showDropArrow:this.get("showDropArrow"),hideModalOverlay:this.get("hideModalOverlay"),classList:this.get("classList"),footContent:this.get("footContent"),headContent:this.get("headContent"),staticWidth:this.get("width"),staticHeight:this.get("height"),positionFixed:this.get("positionFixed"),autoSizeToContent:this.get("autoSizeToContent")})),this.appendAndPosition(),this)},activate:function(){var t=this.get("container"),n=this;return e.OverlayManager.DroparoundOverlay.add(this),this.registerEventHandler(e.on("droparound:reposition",e.bind(this.anchorPositionChange,this))),this.registerEventHandler(e.on("history:change",function(e){if(e.src==="popstate"&&e.prevVal&&e.newVal)if(e.prevVal.flickr&&e.prevVal.flickr.referrer||e.newVal.flickr&&e.newVal.flickr.referrer)return;n.close(e)})),this.get("subview")&&this.loadSubview(),this.get("menuItems")&&this.registerEventHandler(t.one(r.css.menuContent).delegate("click",this.onMenuItemClick.bind(this),"li")),this.get("observePageResize")&&this.observePageResize(),this.get("closeOnScroll")&&this.observePageScroll(),this.fire("activated"),this},getDroparoundContainer:function(){return this.get("container")?this.get("container").one(r.css.droparoundContainer):null},loadSubview:function(){var t,n,i=!1,s=this.get("subview"),o=this;t=this.get("container").one(r.css.subviewContent),t.appendChild(e.Node.create(this.templates("flickr-balls")({})).addClass("flickr-balls")),n=setTimeout(function(){i=!0},40),this.loading=!0,s.appContext=o.appContext,s.set("isActiveViewAgnostic",!0),s.initialize().then(function(e){clearTimeout(n),i&&(e.get("container").addClass("load-transition"),setTimeout(function(){e.get("container").removeClass("load-transition")},1)),o.onSubviewInitialized(e)})},onSubviewInitialized:function(t){var n=this,i=this.get("container").one(r.css.subviewContent);if(!this.loading)return;this.loading=!1,i.one(".flickr-balls").remove(!0),i.appendChild(t.get("container")),t.on("subviewViewEvent",function(e){e&&e.details&&e.details.length&&n.fire.apply(n,e.details)}),t.normalizedActivate(),t.recursivelyActivateSubviews(),n.appendAndPosition(),n.registerEventHandler(n.get("subview").on("actionClick",e.bind(n.handleAction,n)))},onMenuItemClick:function(e){var t,n,i;t=e.target.ancestor("li",!0),t&&(n=this.get("container").one(r.css.menuContent).all("li").indexOf(t),n!==-1&&(i=this.get("menuItems")[n],this.get("multiSelect")&&(i.selected=!i.selected,t.toggleClass("selected")),this.fire("selected",{menuItemIndex:n,menuItem:i})))},appendAndPosition:function(){var t=e.one(r.css.destinationContainer),n=this.get("container").one(r.css.droparoundContainer);t&&(t.append(this.get("container")),i.droparound.width=this.get("width")||n.getComputedStyle("width"),i.droparound.height=this.get("height")||n.getComputedStyle("height"),this.repositionToElement(this.get("anchorElement")))},updateTextMessage:function(e){e&&e!==""&&(this.set("textMessage",e),this.buildContainer())},updateHTMLMessage:function(e){e&&e!==""&&(this.set("htmlMessage",e),this.buildContainer())},anchorPositionChange:function(){this.repositionToElement(this.get("anchorElement"))},observePageResize:function(){var t=this;this.registerEventHandler(e.globalEvents.subscribe("window:resize",function(n){e.fire("droparound:reposition"),t.get("closeOnResize")&&t.handleClose(n)}))},observePageScroll:function(){var t=YUI.Env.isServer?0:e.config.win.pageYOffset,n=this;this.get("startingScrollPoint")||this.set("startingScrollPoint",t),this.registerEventHandler(e.globalEvents.subscribe("window:scroll",n.handleScroll.bind(n)))},handleScroll:function(t){var n,r=this.get("startingScrollPoint");r?(n=e.config.win.pageYOffset,r+this.get("closeOnScrollDistance")<n&&this.handleClose(t)):this.set("startingScrollPoint",e.config.win.pageYOffset)},repositionToElement:function(t){var n=this.get("container"),s=e.one("body"),o=n.one(".droparound"),u=o.one(r.css.droparrow),a=t.getXY(),f=this.get("mirrorArrowAdjustment"),l=s.get("offsetWidth"),c=this.get("showDropArrow"),h=this.get("anchorOffsetVertical"),p=this.get("anchorOffsetHorizontal"),d=this.get("anchorPositionOffset"),v=this.get("minVerticalSpace"),m=o.get("offsetHeight"),g=o.get("offsetWidth"),y=parseInt(t.getComputedStyle("width"),10)||t.get("offsetWidth"),b=parseInt(t.getComputedStyle("height"),10)||t.get("offsetHeight"),w=this.get("dropdownArrowWidth"),E=this.get("dropdownArrowHeight"),S=i.droparound.width?parseInt(i.droparound.width,10):parseInt(o.getComputedStyle("width"),10),x=i.droparound.height?parseInt(i.droparound.height,10):parseInt(o.getComputedStyle("height"),10),T=o.one(r.css.droparoundContent),N=this.get("minHorizontalSpace")+Math.max(m,x),C=l-Math.max(g,S)-d-N,k=t.getDOMNode().getBoundingClientRect(),L,A,O,M,_,D,P,H,B,j,F=this.get("preferLeft"),I=this.get("preferRight"),q=this.get("preferTop"),R=this.get("preferBottom"),U=0,z=this.appContext.viewportData.getHeight(),W={};y||(y=0),b||(b=0),L=Math.ceil
((y-w)/2),M=S||g,_=x||m,A=a[1]-x-h,this.get("horizCenterToAnchor")?(O=a[0]+y/2-M/2,U=M/2-w/2):(O=a[0]-p,U=L+f+p),this.get("preferredSide")?this.get("preferredSide")==="left-middle"?(A=a[1]+Math.round(y/2)-h,O=a[0]+y+L+f+p+E,W.left=L+f-Math.round(E/2)+"px",W.top=(_-E)/2+"px",u.removeClass("down").addClass("left")):this.get("preferredSide")==="bottom-middle"&&(A=a[1]+Math.round(y/2)-h,O=a[0]+y+L+f+p+E,W.left=(M-w)/2-L+f-Math.round(w/2)+"px",W.top=_+"px",u.removeClass("down").addClass("up")):(P=A<v||k.top-x-h<v,H=O>C,B=k.top+k.height+x+h>z,j=O<0||O<a[0],!q&&P||q&&!P||R&&!B?(A=a[1]+b+h,c&&(W.left=U+"px",u.removeClass("up").addClass("down"))):c&&(W.left=U+"px",u.removeClass("down").addClass("up")),this.get("forceLeft")||!F&&H||F&&!H?a[0]+y+p>l?(O=a[0]-S,c&&(delete W.left,W.right=L+y+"px",u.addClass("right"))):(O=a[0]-S+y+p,c&&(delete W.left,W.right=L+p+"px",u.addClass("right"))):this.get("forceRight")||!I&&j||I&&!j?(O=a[0]-y+L,c&&(delete W.right,delete W.left,u.removeClass("right"))):c&&(delete W.right,W.left=U+"px",u.removeClass("right"))),c&&u.setStyles(W),o.setXY([O,A]),!this.get("menuItems")&&!this.get("autoSizeToContent")&&(D={width:M+"px",height:_+"px"},T.setStyles(D))},handleClose:function(e){this.close()},handleAction:function(e){this.fire("actionClick",e),this.get("dismissOnActionClick")&&this.close(e)},show:function(){var e=!this.isActivated,t=this;return this.initialize().then(function(){t.isClosed=!1,e||t.activate()}),this},close:function(){var t=this.get("container");this.loading=!1,this.isClosed=!0,this.fire("closeDroparound"),this.destroy(),this.get("subview")&&this.get("subview").destroy(),t&&t.remove(!0),e.OverlayManager.DroparoundOverlay.remove(this)},destructor:function(){this.detachAll()}},{ATTRS:{dismissOnOverlayClick:{value:!0,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},dismissOnActionClick:{value:!0,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},hideModalOverlay:{value:!0,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},invisibleOverlay:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},preferredSide:{value:null},message:{value:null},textMessage:{value:null},htmlMessage:{value:null},footContent:{value:null},headContent:{value:null},width:{value:0,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},height:{value:0,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},subview:{value:null},menuItems:{value:null},classList:{value:"",validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t,n){return e.AttributeHelpers.coerceString(t)}},anchorElement:{value:null},showDropArrow:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},anchorOffsetVertical:{value:15,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},anchorOffsetHorizontal:{value:5,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},contentPadding:{value:12,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},minVerticalSpace:{value:60,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},minHorizontalSpace:{value:60,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},dropdownArrowWidth:{value:21,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},dropdownArrowHeight:{value:11},anchorPositionOffset:{value:15,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},observePageResize:{value:!0,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},preferLeft:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},preferRight:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},preferTop:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},preferBottom:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},mirrorArrowAdjustment:{value:0,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},positionFixed:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},closeOnScroll:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},closeOnScrollDistance:{value:40,validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},closeOnResize:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers
.coerceBoolean(t)}},overlayClassList:{value:"",validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t,n){return e.AttributeHelpers.coerceString(t)}},forceLeft:{value:null},forceRight:{value:null},autoSizeToContent:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},horizCenterToAnchor:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}},multiSelect:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t,n){return e.AttributeHelpers.coerceBoolean(t)}}}})},"@VERSION@",{requires:["flickr-view","fluid-css","hermes-template-fluid-droparound","fluid-balls-css","hermes-template-flickr-balls","fluid-overlay-manager-view","attribute-helpers"],optionalRequires:["fluid"]});
YUI.add("hermes-template-person-card",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i,s;r+="\n					"+l((i=(i=e.person,i==null||i===!1?i:i.realname),typeof i===f?i.apply(e):i))+"\n					",s=n["if"].call(e,e.personLocation,{hash:{},inverse:c.noop,fn:c.program(2,d,t),data:t});if(s||s===0)r+=s;return r+="\n				",r}function d(e,t){return" - "}function v(e,t){var r="",i;r+="\n			",i=n.each.call(e,e.photostream,{hash:{},inverse:c.noop,fn:c.program(5,m,t),data:t});if(i||i===0)r+=i;return r+="\n		",r}function m(e,t){var r="",i;r+="\n				",i=n["if"].call(e,e.needsInterstitial,{hash:{},inverse:c.program(8,y,t),fn:c.program(6,g,t),data:t});if(i||i===0)r+=i;return r+="\n			",r}function g(e,t){var r="",i;return r+='\n					<a href="',(i=n.url)?i=i.call(e,{hash:{},data:t}):(i=e.url,i=typeof i===f?i.apply(e):i),r+=l(i)+'" title="',(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===f?i.apply(e):i),r+=l(i)+'" width="'+l((i=(i=(i=e.sizes,i==null||i===!1?i:i.sq),i==null||i===!1?i:i.width),typeof i===f?i.apply(e):i))+'" height="'+l((i=(i=(i=e.sizes,i==null||i===!1?i:i.sq),i==null||i===!1?i:i.height),typeof i===f?i.apply(e):i))+'" style="background: url(https://s.yimg.com/pw/images/spaceball.gif);" data-track="personCardRecentPhotosClick"></a>\n				',r}function y(e,t){var r="",i;return r+='\n					<a href="',(i=n.url)?i=i.call(e,{hash:{},data:t}):(i=e.url,i=typeof i===f?i.apply(e):i),r+=l(i)+'" title="',(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===f?i.apply(e):i),r+=l(i)+'" style="background: url('+l((i=(i=(i=e.sizes,i==null||i===!1?i:i.sq),i==null||i===!1?i:i.displayUrl),typeof i===f?i.apply(e):i))+');" data-track="personCardRecentPhotosClick"></a>\n				',r}function b(e,t){var r="",i,s;return r+='\n			<span class="tertiary">',s={hash:{intlName:"person.NO_PHOTOS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+"</span>\n		",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='\n<div>\n	<section>\n		<div class="follow-subview">',a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["follow-view"],a):h.call(t,"outlet",t["follow-view"],a)))+'</div>\n\n		<div class="attribution">\n			<a href="'+l((o=(o=t.personURLS,o==null||o===!1?o:o.photostream),typeof o===f?o.apply(t):o))+'" data-track="personCardAttributionNameClick">\n				<h3 class="fade-out">'+l((o=(o=t.person,o==null||o===!1?o:o.username),typeof o===f?o.apply(t):o))+'</h3>\n			</a>\n		</div>\n		<div class="info">\n			<span class="secondary realname fade-out">\n				',u=n["if"].call(t,(o=t.person,o==null||o===!1?o:o.realname),{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(u||u===0)s+=u;s+="\n				",(u=n.personLocation)?u=u.call(t,{hash:{},data:i}):(u=t.personLocation,u=typeof u===f?u.apply(t):u),s+=l(u)+'\n			</span>\n		</div>\n\n		<div class="recent-photos">\n		',u=n["if"].call(t,t.photostream,{hash:{},inverse:c.program(10,b,i),fn:c.program(4,v,i),data:i});if(u||u===0)s+=u;return s+='\n		</div>\n	</section>\n</div>\n\n<div class="links secondary">\n	<a href="'+l((o=(o=t.personURLS,o==null||o===!1?o:o.sendFlickrMail),typeof o===f?o.apply(t):o))+'" data-track="personCardMessageClick">',a={hash:{intlName:"person.MESSAGE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a>\n	<a href="'+l((o=(o=t.personURLS,o==null||o===!1?o:o.albums),typeof o===f?o.apply(t):o))+'" data-track="personCardAlbumsClick">',a={hash:{intlName:"person.ALBUMS"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a>\n	<a href="'+l((o=(o=t.personURLS,o==null||o===!1?o:o.favorites),typeof o===f?o.apply(t):o))+'" data-track="personCardFavesClick">',a={hash:{intlName:"person.FAVES"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a>\n	<a class="align-right" href="'+l((o=(o=t.personURLS,o==null||o===!1?o:o.profile),typeof o===f?o.apply(t):o))+'" data-track="personCardProfileClick">',a={hash:{intlName:"person.PROFILE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+"</a>\n</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/person-card",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("person-card-view",function(e){e.namespace("Views")[this.name]=e.Base.create("person-card-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.nsid=e.nsid,this.pathAlias=e.pathAlias,this.set("isActiveViewAgnostic",e.isActiveViewAgnostic||!1),this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},subviewConfig:{"follow-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1}},loadState:function(){var t=this,n={contentType:7};return this.nsid?n.id=this.nsid:n.pathAlias=this.pathAlias,(new e.FlickrPromise({person:this.appContext.getModel("person-models",n),photostream:this.appContext.getModel("photostream-models",n),personProfile:this.appContext.getModel("person-profile-models",n)})).then(function(e){return t.personModel=e.person,t.personLocation=e.personProfile.getValue("location"),e.photostream.getValue("photoPageList").getPage({page:1,perPage:5}).then(function(e){t.photostreamPhotos=e})},function(e){t.loadingError=!0,e.code===1&&e.message==="User not found"&&(t.badUser=!0)})},buildContainer:function(){var t,n;return this.loadingError?this.badUser?n='<span class="no-user">'+this.intlMessage({intlName:"person.NO_LONGER_ON_FLICKR"})+"</span>":n='<span class="error-user">'+this.intlMessage({intlName:"person.ERROR_LOADING"})+"</span>":(t=this.personModel.toJSON(),n=this.templates("person-card")({person:t,photostream:this.photostreamPhotos.map(function(e){return e.toJSON()}),personLocation:this.personLocation,personURLS:e.URLHelper.generatePersonUrls(this.personModel),"follow-view":this.subviews["follow-view"].get("container")})),this.setContainerHTML(n),this},activate:function(){var e=this.get("container"),t=e.one(".follow-view"),n=t.one(".relationship"),r=t.one(".relationship > .is-following"),i=e.one(".attribution");return n?r&&i.addClass("shorter"):i.addClass("full"),this}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-person-card","person-card-css","url-helper"],langBundles:["person","common"]});
YUI.add("hermes-lang-person",function(e,t){e.Intl.add("hermes/person","en-US",{MESSAGE:["Message"],ALBUMS:["Albums"],FAVES:["Faves"],PROFILE:["Profile"],NO_PHOTOS:["This user has no photos visible to you."],NO_LONGER_ON_FLICKR:["This user is not found, or no longer on Flickr."],ERROR_LOADING:["Error loading user card. Please try again."],RELATIONSHIP_FRIEND_ERROR:["There was a problem setting your friend relationship."],RELATIONSHIP_FAMILY_ERROR:["There was a problem setting your family relationship."],SIGN_IN_BEFORE_FOLLOW_TITLE:["You found someone to follow!"],SIGN_IN_BEFORE_FOLLOW_MESSAGE:["That's awesome. Just sign in to follow them."],JOIN_FLICKR_AND_FOLLOW:["Join Flickr to never miss a post from ","${person}","."],SIGN_IN_AND_FOLLOW:["Sign in and follow"],CURATOR_PASS_OVER:["Pass over"],CURATOR_PASS_OVER_UNDO:["Undo pass over"]})},"@VERSION@",{requires:["intl"]});
YUI.add("person-menu-view",function(e){var t=require("lib/helpers/type-validator");"use strict",e.namespace("Views")[this.name]=e.Base.create("person-menu-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.containerSelector=e.containerSelector,this.excludeSelectors=[".no-menu"].concat(e.excludeSelectors||[]),this.personSelector=".avatar.person, .photo-attribution .attribution-icon, .comment-icon.circle-icon a, .show-person-menu",this.dialogCache=[],this.currentDialog,this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerHTML(""),this},toJSON:function(){var t=e.merge(this.get("user"));return t},activate:function(){this.registerEventHandler(e.one(this.containerSelector).delegate("click",this.onClickTarget.bind(this),this.personSelector,this))},onClickTarget:function(t){var n=this,r;this.shouldProcessTarget(t.target)&&(t.preventDefault(),t.halt(),r=t.target.ancestor().one(this.personSelector)||t.target.ancestor(this.personSelector)||t.target.ancestor("a"),this.createParamsAndManageState(r),e.rapidTracker.beacon(n.name,"personCardOpened"))},shouldProcessTarget:function(e){return e.ancestor()!==null&&!this.excludeSelectors.some(function(t){return e.ancestor().one(t)||e.ancestor(t)})},createParamsAndManageState:function(e){var t=this.getParams(e);this.createDialog(t,e)},getParams:function(e){var n={appContext:this.appContext,isActiveViewAgnostic:!0},r="",i;return r=e.getData("person-nsid")||e.ancestor().getData("person-nsid"),r||(i=e.getAttribute("href")||e.ancestor().getAttribute("href"),i.indexOf("/photos")===0?r=i.replace("/photos/","").replace("/",""):i.indexOf("/groups/")===0&&(r=i.slice(i.lastIndexOf("/")+1))),t.nsid(r)?n.nsid=r:n.pathAlias=r,n.signature=r,n},createDialog:function(t,n){var r,i=this;this.fire("open"),e.fire("personMenuOpen"),this.dialogCache.some(function(e){return e.key===t.signature?(r=e.dialog,!0):!1}),r?r.set("anchorElement",n.ancestor().hasClass("comment-icon")?n.ancestor():n):(r=new e.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,showDropArrow:!0,width:350,height:165,observePageResize:!0,anchorElement:n.ancestor().hasClass("comment-icon")?n.ancestor():n,subview:new e.Views["person-card-view"](t)}),r.on("clickOverlay",function(e){i.nextElClicked=[e.clientX,e.clientY]}),r.on("closeDroparound",function(){setTimeout(function(){if(i.nextElClicked){var t=document.elementFromPoint(i.nextElClicked[0],i.nextElClicked[1]),n;t&&(n=e.one(t),n&&i.personSelector.split(",").some(function(e){return n.hasClass(e.replace(".",""))})&&i.shouldProcessTarget(n)&&i.createParamsAndManageState(n)),i.nextElClicked=null}},10)}),this.dialogCache.length>10&&this.dialogCache.shift(),this.dialogCache.push({key:t.signature,dialog:r})),this.currentDialog=r,r.show()},closeDialog:function(){this.currentDialog&&(this.currentDialog.close(),e.fire("personMenuClose"))},destructor:function(){var t=this;this.currentDialog=null,e.Object.each(this.dialogCache,function(e){t.dialogCache[e]&&(t.dialogCache[e].destroy(),t.dialogCache[e]=null)}),this.dialogCache=[]}})},"@VERSION@",{requires:["flickr-promise","flickr-view","account-menu-css","flickrui-css","dialog","fluid-droparound-view","person-card-view"],langBundles:["person","common"]});
YUI.add("hermes-template-group-card",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i;r+="\n			",i=n.each.call(e,e.groupPool,{hash:{},inverse:c.noop,fn:c.program(2,d,t),data:t});if(i||i===0)r+=i;return r+="\n		",r}function d(e,t){var r="",i,s;r+='\n				\n				<a href="',(i=n.url)?i=i.call(e,{hash:{},data:t}):(i=e.url,i=typeof i===f?i.apply(e):i),r+=l(i)+'" title="',(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===f?i.apply(e):i),r+=l(i)+'" width="'+l((i=(i=(i=e.sizes,i==null||i===!1?i:i.sq),i==null||i===!1?i:i.width),typeof i===f?i.apply(e):i))+'" height="'+l((i=(i=(i=e.sizes,i==null||i===!1?i:i.sq),i==null||i===!1?i:i.height),typeof i===f?i.apply(e):i))+'"\n				',s=n["if"].call(e,e.needsInterstitial,{hash:{},inverse:c.program(5,m,t),fn:c.program(3,v,t),data:t});if(s||s===0)r+=s;return r+="\n				></a>\n				\n			",r}function v(e,t){return'\n					class="restricted"\n				'}function m(e,t){var n="",r;return n+='\n					style="background: url('+l((r=(r=(r=e.sizes,r==null||r===!1?r:r.sq),r==null||r===!1?r:r.displayUrl),typeof r===f?r.apply(e):r))+');"\n				',n}function g(e,t){var r="",i;r+="\n			",i=n["if"].call(e,e.canAddPhotos,{hash:{},inverse:c.program(10,b,t),fn:c.program(8,y,t),data:t});if(i||i===0)r+=i;return r+="\n		",r}function y(e,t){var r="",i,s;return r+='\n				<p class="tertiary">',s={hash:{intlName:"groups.BE_THE_FIRST"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+'</p>\n				<p class="tertiary"><a href="'+l((i=(i=e.groupURLS,i==null||i===!1?i:i.photos),typeof i===f?i.apply(e):i))+'">',s={hash:{intlName:"groups.ADD_SOME_PHOTOS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+"</a></p>\n			",r}function b(e,t){var r="",i,s;return r+="\n				<p>",s={hash:{intlName:"groups.NO_PHOTOS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+"</p>\n			",r}function w(e,t){var r="",i,s;return r+='\n	<a href="'+l((i=(i=e.groupURLS,i==null||i===!1?i:i.admin),typeof i===f?i.apply(e):i))+'">',s={hash:{intlName:"groups.ADMIN_LINK_LABEL"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+"</a>\n	",r}function E(e,t){var r="",i,s;r+="\n		",s=n["if"].call(e,(i=e.group,i==null||i===!1?i:i.isModerator),{hash:{},inverse:c.noop,fn:c.program(15,S,t),data:t});if(s||s===0)r+=s;return r+="\n	",r}function S(e,t){var r="",i,s;return r+='\n		<a href="'+l((i=(i=e.groupURLS,i==null||i===!1?i:i.admin),typeof i===f?i.apply(e):i))+'">',s={hash:{intlName:"groups.ADMIN_LINK_LABEL"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+"</a>\n		",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='\n<div>\n	<section>\n		<div class="join-subview">\n\n			',a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["join-group-view"],a):h.call(t,"outlet",t["join-group-view"],a)))+'\n\n		</div>\n\n		<div class="attribution">\n			<a href="'+l((o=(o=t.groupURLS,o==null||o===!1?o:o.about),typeof o===f?o.apply(t):o))+'">\n				<h3 class="fade-out">',a={hash:{},data:i},s+=l((o=n.renderTrustedMarkup||t.renderTrustedMarkup,o?o.call(t,(o=t.group,o==null||o===!1?o:o.title),a):h.call(t,"renderTrustedMarkup",(o=t.group,o==null||o===!1?o:o.title),a)))+'</h3>\n			</a>\n		</div>\n		<div class="stats">\n			<span class="secondary fade-out">',a={hash:{intlName:"groups.CREATED_YEAR",createdYear:t.createdYear},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+" - ",a={hash:{intlName:"groups.UPDATED_TIME_AGO",updatedAgo:t.updatedAgo},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</span>\n		</div>\n\n		<div class="recent-photos">\n		',u=n["if"].call(t,t.groupPool,{hash:{},inverse:c.program(7,g,i),fn:c.program(1,p,i),data:i});if(u||u===0)s+=u;s+='\n		</div>\n	</section>\n</div>\n\n<div class="links secondary">\n	<a href="'+l((o=(o=t.groupURLS,o==null||o===!1?o:o.photos),typeof o===f?o.apply(t):o))+'">',a={hash:{intlName:"groups.PHOTOS_LINK_LABEL"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+'</a>\n	<a href="'+l((o=(o=t.groupURLS,o==null||o===!1?o:o.discussions),typeof o===f?o.apply(t):o))+'">',a={hash:{intlName:"groups.DISCUSSIONS_LINK_LABEL"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):h.call(t,"intlMessage",a)))+"</a>\n	",u=n["if"].call(t,(o=t.group,o==null||o===!1?o:o.isAdmin),{hash:{},inverse:c.program(14,E,i),fn:c.program(12,w,i),data:i});if(u||u===0)s+=u;return s+="\n</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/group-card",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("group-card-view",function(e){e.namespace("Views")[this.name]=e.Base.create("group-card-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.groupId=e.groupId,this.groupPathAlias=e.groupPathAlias,this.set("isActiveViewAgnostic",e.isActiveViewAgnostic||!1),this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},subviewConfig:{"join-group-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,shortLabels:!0,theme:"light"}},loadState:function(){var t=this,n=this.groupId;return(new e.FlickrPromise({groupPool:this.appContext.getModel("group-pool-models",n),group:this.appContext.getModel("group-models",n),groupInfo:this.appContext.getModel("group-info-models",n)})).then(function(e){return t.groupModel=e.group,t.groupInfo=e.groupInfo,e.groupPool.getValue("photoPageList").getPage({page:1,perPage:5}).then(function(e){t.groupPhotos=e})},function(e){t.loadingError=!0})},buildContainer:function(){var t,n,r=!1,i;return this.loadingError?n='<span class="error-group">'+this.intlMessage({intlName:"groups.ERROR_LOADING"})+"</span>":(t=this.groupModel.toJSON(),i=this.groupInfo.getValue("throttle"),r=i.mode!=="disabled"&&i.remaining>0||i.mode==="none",r&&(r=t.isMember),n=this.templates("group-card")({group:t,groupPool:this.groupPhotos.map(function(e){return e.toJSON()}),canAddPhotos:r,groupURLS:e.URLHelper.generateGroupUrls(this.groupModel),createdYear:t.dateCreated.year(),updatedAgo:this.intlMessage(e.Handlebars.helpers._friendlySinceDate(t.latestGroupActivity,!0,!0)),"join-group-view":this.subviews["join-group-view"].get("container")})),this.setContainerHTML(n),this},activate:function(){return this.registerEventHandler(this.get("container").delegate("click",function(e){e.preventDefault(),console.log("join group")},".join")),this}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-group-card","group-card-css","url-helper","handlebars-helpers"],langBundles:["groups","relative-dates"]});
YUI.add("hermes-lang-relative-dates",function(e,t){e.Intl.add("hermes/relative-dates","en-US",{SECOND_LONG:["1 second"],SECONDS_LONG:["${time}"," seconds"],MINUTE_LONG:["1 min"],MINUTES_LONG:["${time}"," mins"],HOUR_LONG:["1 hour"],HOURS_LONG:["${time}"," hours"],DAY_LONG:["1 day"],DAYS_LONG:["${time}"," days"],MONTH_LONG:["1 month"],MONTHS_LONG:["${time}"," months"],YEAR_LONG:["1 year"],YEARS_LONG:["${time}"," years"],SECOND_SHORT:["1s"],SECONDS_SHORT:["${time}","s"],MINUTE_SHORT:["1m"],MINUTES_SHORT:["${time}","m"],HOUR_SHORT:["1h"],HOURS_SHORT:["${time}","h"],DAY_SHORT:["1d"],DAYS_SHORT:["${time}","d"],MONTH_SHORT:["1mo"],MONTHS_SHORT:["${time}","mo"],YEAR_SHORT:["1y"],YEARS_SHORT:["${time}","y"],SECOND_LONG_FUTURE:["in 1 second"],SECONDS_LONG_FUTURE:["in ","${time}"," seconds"],MINUTE_LONG_FUTURE:["in 1 min"],MINUTES_LONG_FUTURE:["in ","${time}"," mins"],HOUR_LONG_FUTURE:["in 1 hour"],HOURS_LONG_FUTURE:["in ","${time}"," hours"],DAY_LONG_FUTURE:["in 1 day"],DAYS_LONG_FUTURE:["in ","${time}"," days"],MONTH_LONG_FUTURE:["in 1 month"],MONTHS_LONG_FUTURE:["in ","${time}"," months"],YEAR_LONG_FUTURE:["in 1 year"],YEARS_LONG_FUTURE:["in ","${time}"," years"],FUTURE_SHORT_FUTURE:["in ","${time}"],SECOND_SHORT_FUTURE:["in 1s"],SECONDS_SHORT_FUTURE:["in ","${time}","s"],MINUTE_SHORT_FUTURE:["in 1m"],MINUTES_SHORT_FUTURE:["in ","${time}","m"],HOUR_SHORT_FUTURE:["in 1h"],HOURS_SHORT_FUTURE:["in ","${time}","h"],DAY_SHORT_FUTURE:["in 1d"],DAYS_SHORT_FUTURE:["in ","${time}","d"],MONTH_SHORT_FUTURE:["in 1mo"],MONTHS_SHORT_FUTURE:["in ","${time}","mo"],YEAR_SHORT_FUTURE:["in 1y"],YEARS_SHORT_FUTURE:["in ","${time}","y"],SECOND_LONG_PAST:["1 second ago"],SECONDS_LONG_PAST:["${time}"," seconds ago"],MINUTE_LONG_PAST:["1 min ago"],MINUTES_LONG_PAST:["${time}"," mins ago"],HOUR_LONG_PAST:["1 hour ago"],HOURS_LONG_PAST:["${time}"," hours ago"],DAY_LONG_PAST:["1 day ago"],DAYS_LONG_PAST:["${time}"," days ago"],MONTH_LONG_PAST:["1 month ago"],MONTHS_LONG_PAST:["${time}"," months ago"],YEAR_LONG_PAST:["1 year ago"],YEARS_LONG_PAST:["${time}"," years ago"],SECOND_SHORT_PAST:["1s ago"],SECONDS_SHORT_PAST:["${time}","s ago"],MINUTE_SHORT_PAST:["1m ago"],MINUTES_SHORT_PAST:["${time}","m ago"],HOUR_SHORT_PAST:["1h ago"],HOURS_SHORT_PAST:["${time}","h ago"],DAY_SHORT_PAST:["1d ago"],DAYS_SHORT_PAST:["${time}","d ago"],MONTH_SHORT_PAST:["1mo ago"],MONTHS_SHORT_PAST:["${time}","mo ago"],YEAR_SHORT_PAST:["1y ago"],YEARS_SHORT_PAST:["${time}","y ago"],NO_DATE:["-"]})},"@VERSION@",{requires:["intl"]});
YUI.add("group-menu-view",function(e){"use strict";e.namespace("Views")[this.name]=e.Base.create("group-menu-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.containerSelector=e.containerSelector,this.excludeSelectors=[".large",".no-menu"].concat(e.excludeSelectors||[]),this.groupSelector=".avatar.group",this.dialogCache=[],this.currentDialog,this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerHTML(""),this},activate:function(){this.registerEventHandler(e.one(this.containerSelector).delegate("click",this.onClickTarget.bind(this),this.groupSelector,this))},onClickTarget:function(e){var t;this.shouldProcessTarget(e.target)&&(e.preventDefault(),e.halt(),t=e.target,this.createParamsAndManageState(t))},shouldProcessTarget:function(e){return e.ancestor()!==null&&!this.excludeSelectors.some(function(t){return e.ancestor().one(t)||e.ancestor(t)})},createParamsAndManageState:function(e){var t=this.getParams(e);this.createDialog(t,e)},getParams:function(e){var t={appContext:this.appContext,isActiveViewAgnostic:!0};return t.groupId=e.getData("group-nsid"),t.signature=t.groupId,t},createDialog:function(t,n){var r=this,i;this.fire("open"),this.dialogCache.some(function(e){return e.key===t.signature?(i=e.dialog,!0):!1}),i?i.set("anchorElement",n):(i=new e.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,showDropArrow:!0,width:350,height:165,observePageResize:!0,anchorElement:n,subview:new e.Views["group-card-view"](t)}),i.on("clickOverlay",function(e){r.nextElClicked=[e.clientX,e.clientY]}),i.on("closeDroparound",function(){setTimeout(function(){if(r.nextElClicked){var t=document.elementFromPoint(r.nextElClicked[0],r.nextElClicked[1]),n,i;t&&(n=e.one(t),i=r.groupSelector.split(",").some(function(e){return n.hasClass(e.replace(".",""))}),n&&i&&r.shouldProcessTarget(n)&&r.createParamsAndManageState(n)),r.nextElClicked=null}},10)}),this.dialogCache.length>10&&this.dialogCache.shift(),this.dialogCache.push({key:t.signature,dialog:i})),this.currentDialog=i,i.show()},closeDialog:function(){this.currentDialog&&this.currentDialog.close()},destructor:function(){var t=this;this.currentDialog=null,e.Object.each(this.dialogCache,function(e){t.dialogCache[e]&&(t.dialogCache[e].destroy(),t.dialogCache[e]=null)}),this.dialogCache=null}})},"@VERSION@",{requires:["flickr-promise","flickr-view","account-menu-css","flickrui-css","dialog","fluid-droparound-view","group-card-view"],langBundles:["common"]});
YUI.add("hermes-template-fluid-modal",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){return" html-modal"}function h(e,t){return" subview-modal"}function p(e,t){return'<div class="close-x"></div>'}function d(e,t){var r="",i;r+='\n		<div class="head">\n			',i=n["if"].call(e,e.navBarView,{hash:{},inverse:l.program(10,m,t),fn:l.program(8,v,t),data:t});if(i||i===0)r+=i;return r+='\n			<div class="extra"></div>\n		</div>\n	',r}function v(e,t){return'\n				<div class="nav"></div>\n			'}function m(e,t){var r="",i;r+='\n				<div class="title">\n					',i=n["if"].call(e,e.title,{hash:{},inverse:l.program(13,y,t),fn:l.program(11,g,t),data:t});if(i||i===0)r+=i;return r+="\n				</div>\n			",r}function g(e,t){var r="",i;return r+="\n						",(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===u?i.apply(e):i),r+=a(i)+"\n					",r}function y(e,t){var r="",i,s;return r+="\n						",s={hash:{},data:t},r+=a((i=n.renderTrustedMarkup||e.renderTrustedMarkup,i?i.call(e,e.htmlTitle,s):f.call(e,"renderTrustedMarkup",e.htmlTitle,s)))+"\n					",r}function b(e,t){return" lines"}function w(e,t){var r="",i;r+='\n			<div class="content text-only ',i=n["if"].call(e,e.noScroll,{hash:{},inverse:l.noop,fn:l.program(18,E,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,e.showFooter,{hash:{},inverse:l.noop,fn:l.program(20,S,t),data:t});if(i||i===0)r+=i;return r+='">\n				',(i=n.textMessage)?i=i.call(e,{hash:{},data:t}):(i=e.textMessage,i=typeof i===u?i.apply(e):i),r+=a(i)+"\n			</div>\n		",r}function E(e,t){return" no-scroll"}function S(e,t){return" has-footer"}function x(e,t){var r="",i,s;r+='\n			<div class="content html-only ',i=n["if"].call(e,e.noScroll,{hash:{},inverse:l.noop,fn:l.program(18,E,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,e.showFooter,{hash:{},inverse:l.noop,fn:l.program(20,S,t),data:t});if(i||i===0)r+=i;return r+='">\n				',s={hash:{},data:t},r+=a((i=n.renderTrustedMarkup||e.renderTrustedMarkup,i?i.call(e,e.htmlMessage,s):f.call(e,"renderTrustedMarkup",e.htmlMessage,s)))+"\n			</div>\n		",r}function T(e,t){var r="",i;r+='\n			<div class="content subview ',i=n["if"].call(e,e.noScroll,{hash:{},inverse:l.noop,fn:l.program(18,E,t),data:t});if(i||i===0)r+=i;i=n["if"].call(e,e.showFooter,{hash:{},inverse:l.noop,fn:l.program(20,S,t),data:t});if(i||i===0)r+=i;return r+='"></div>\n		',r}function N(e,t){var r="",i,s;r+='\n		<div class="foot">\n			',s=n["if"].call(e,(i=e.buttons,i==null||i===!1?i:i.visible),{hash:{},inverse:l.noop,fn:l.program(27,C,t),data:t});if(s||s===0)r+=s;return r+="\n		</div>\n	",r}function C(e,t){var r="",i,s;r+='\n			<div class="buttons">\n				',s=n["if"].call(e,(i=(i=e.buttons,i==null||i===!1?i:i.action),i==null||i===!1?i:i.visible),{hash:{},inverse:l.noop,fn:l.program(28,k,t),data:t});if(s||s===0)r+=s;r+="\n				",s=n["if"].call(e,(i=(i=e.buttons,i==null||i===!1?i:i.cancel),i==null||i===!1?i:i.visible),{hash:{},inverse:l.noop,fn:l.program(33,O,t),data:t});if(s||s===0)r+=s;r+="\n				",s=n["if"].call(e,(i=e.buttons,i==null||i===!1?i:i.flavorText),{hash:{},inverse:l.noop,fn:l.program(35,M,t),data:t});if(s||s===0)r+=s;return r+="\n			</div>\n			",r}function k(e,t){var r="",i,s;r+='<button class="mini ',s=n["if"].call(e,(i=(i=e.buttons,i==null||i===!1?i:i.action),i==null||i===!1?i:i.isDangerous),{hash:{},inverse:l.noop,fn:l.program(29,L,t),data:t});if(s||s===0)r+=s;r+=' action"',s=n["if"].call(e,(i=(i=e.buttons,i==null||i===!1?i:i.action),i==null||i===!1?i:i.disabled),{hash:{},inverse:l.noop,fn:l.program(31,A,t),data:t});if(s||s===0)r+=s;return r+=">"+a((i=(i=(i=e.buttons,i==null||i===!1?i:i.action),i==null||i===!1?i:i.label),typeof i===u?i.apply(e):i))+"</button>",r}function L(e,t){return"danger"}function A(e,t){return' disabled="disabled"'}function O(e,t){var n="",r;return n+='<button class="mini alt cancel">'+a((r=(r=(r=e.buttons,r==null||r===!1?r:r.cancel),r==null||r===!1?r:r.label),typeof r===u?r.apply(e):r))+"</button>",n}function M(e,t){var r="",i,s,o;r+='\n				<div class="flavor-text secondary',s=n.unless.call(e,(i=(i=e.buttons,i==null||i===!1?i:i.flavorText),i==null||i===!1?i:i.visible),{hash:{},inverse:l.noop,fn:l.program(36,_,t),data:t});if(s||s===0)r+=s;return r+='">',o={hash:{},data:t},r+=a((i=n.renderTrustedMarkup||e.renderTrustedMarkup,i?i.call(e,(i=(i=e.buttons,i==null||i===!1?i:i.flavorText),i==null||i===!1?i:i.text),o):f.call(e,"renderTrustedMarkup",(i=(i=e.buttons,i==null||i===!1?i:i.flavorText),i==null||i===!1?i:i.text),o)))+"</div>\n				",r}function _(e,t){return" hidden"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=n.helperMissing,l=this;s+='<div class="modal',o=n["if"].call(t,t.htmlMessage,{hash:{},inverse:l.noop,fn:l.program(1,c,i),data:i});if(o||o===0)s+=o;o=n["if"].call(t,t.subview,{hash:{},inverse:l.noop,fn:l.program(3,h,i),data:i});if(o||o===0)s+=o;s+=" ",(o=n.classList)?o=o.call(t,{hash:{},data:i}):(o=t.classList,o=typeof o===u?o.apply(t):o),s+=a(o)+'">\n	',o=n["if"].call(t,t.showCancelX,{hash:{},inverse:l.noop,fn:l.program(5,p,i),data:i});if(o||o===0)s+=o;s+="\n	",o=n["if"].call(t,t.showHeader,{hash:{},inverse:l.noop,fn:l.program(7,d,i),data:i});if(o||o===0)s+=o;s+='\n	<div class="body',o=n["if"].call(t,t.showBodyLines,{hash:{},inverse:l.noop,fn:l.program(15,b,i),data:i});if(o||o===0)s+=o;s+='">\n		',o=n["if"].call(t,t.textMessage,{hash:{},inverse:l.noop,fn:l.program(17,w,i),data:i});if(o||o===0)s+=o;s+="\n		",o=n["if"].call(t,t.htmlMessage,{hash:{},inverse:l.noop,fn:l.program(22,x,i),data:i});if(o||o===0)s+=o;s+="\n		",o=n["if"].call(t,t.subview,{hash:{},inverse:l.noop,fn:l.program(24,T,i),data:i});if(o||o===0)s+=o;s+="\n	</div>\n	",o=n["if"].call(t,t.showFooter,{hash:{},inverse:l.noop,fn:l.program(26,N,i),data:i});if(o||o===0)s+=o;return s+="\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/fluid-modal",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials
):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("fluid-modal-view",function(e,t){"use strict";var n=require("lib/flog")(t),r,i;r={css:{destinationContainer:"body",closeX:".close-x",buttonCancel:"button.cancel",buttonAction:"button.action",navBarContent:".head .nav",subviewContent:".content.subview",modalContent:".body .content"},options:{}},i={supportsTransform:!1,modal:{height:0,width:0}},e.namespace("Views").FluidModal=e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){this.set("isActiveViewAgnostic",!0);var t=this.get("modalOverlayType");return this.alreadyShowingModal=t.alreadyShowingModal(),this.alreadyShowingModal||t.add(this),this},activate:function(){var t=this.get("container"),n=this;return this.get("showCancelX")&&this.registerEventHandler(t.one(r.css.closeX).on("click",e.bind(this.handleCancel,this))),this.get("showFooter")&&this.get("showCancelButton")&&this.get("showButtons")&&this.registerEventHandler(t.one(r.css.buttonCancel).on("click",e.bind(this.handleCancel,this))),this.get("showFooter")&&this.get("showActionButton")&&this.get("showButtons")&&this.registerEventHandler(t.one(r.css.buttonAction).on("click",e.bind(this.handleAction,this))),this.registerEventHandler(this.appContext.flapp.on("activeViewChange",function(e){n.close(e)})),this.registerEventHandler(e.globalEvents.subscribe("window:resize",function(e){n.reposition()})),this.get("navBarView")&&n.get("navBarView").activate(),this.get("subview")&&(n.get("subview").activate(),n.registerEventHandler(n.get("subview").on("actionClick",e.bind(n.handleAction,n)))),this.fire("activated"),this},show:function(){return this.initialize().then(null,function(e){n.error("Error initializing modal",{err:e})}),this.isClosed=!1,this.freeze(),e.fire("flickr:setKeyEventScope",this.getKeyEventScope()),this},freeze:function(){e.one("body").setStyles({overflow:"hidden"})},unfreeze:function(){e.one("body").setStyles({overflow:"visible"})},enableActionButton:function(){var e=this.get("container").one("button.action");e&&e.getAttribute("disabled")&&e.removeAttribute("disabled")},disableActionButton:function(){var e=this.get("container").one("button.action");e&&e.setAttribute("disabled",!0)},showFlavorText:function(){var e=this.get("container").one(".buttons .flavor-text");e&&e.removeClass("hidden")},hideFlavorText:function(){var e=this.get("container").one(".buttons .flavor-text");e&&e.addClass("hidden")},buildContainer:function(){if(!this.alreadyShowingModal){var t=this,s=e.one(r.css.destinationContainer),o;o={showCancelX:this.get("showCancelX"),title:this.get("title"),htmlTitle:this.get("htmlTitle"),navBarView:!!this.get("navBarView"),noScroll:this.get("noScroll"),textMessage:this.get("textMessage"),htmlMessage:this.get("message")?this.get("message"):this.get("htmlMessage"),subview:!!this.get("subview"),showBodyLines:this.get("showBodyLines"),hideModalOverlay:this.get("hideModalOverlay"),darkOverlay:this.get("darkOverlay"),showHeader:this.get("showHeader"),showFooter:this.get("showFooter"),buttons:{visible:this.get("showButtons"),action:{visible:this.get("showActionButton"),label:this.get("actionButtonLabel"),disabled:this.get("actionButtonDisabled"),isDangerous:this.get("actionButtonIsDangerous")},cancel:{visible:this.get("showCancelButton"),label:this.get("cancelButtonLabel")}},classList:this.get("classList")},this.get("buttonFlavorText")&&(o.buttons.flavorText={visible:this.get("showButtonFlavorText"),text:this.get("buttonFlavorText")}),this.setContainerHTML(this.templates("fluid-modal")(o)),i.modal.width=this.get("width"),i.modal.minWidth=this.get("minWidth"),i.modal.height=this.get("height"),this.get("navBarView")&&(this.get("navBarView").appContext=t.appContext,this.get("navBarView").initialize().then(function(e){e.on("subviewViewEvent",function(e){e&&e.details&&e.details.length&&(t.get("subview")&&e.details[0]==="navigation"?t.get("subview").fire.apply(t.get("subview"),["parentViewEvent"].concat(e.details)):t.get("subview")&&e.details[0]==="search"&&t.get("subview").fire.apply(t.get("subview"),["parentViewEvent"].concat(e.details)),t.fire.apply(t,e.details))}),t.get("container").one(r.css.navBarContent).appendChild(e.get("container")),t.get("subview")||t.activate()})),this.get("subview")?(this.get("subview").appContext=t.appContext,this.get("subview").set("isActiveViewAgnostic",!0),this.get("subview").initialize().then(function(e){t.on("parentViewEvent",function(t){t&&t.details&&t.details.length&&e.fire.apply(e,["parentViewEvent"].concat(t.details))}),e.on("subviewViewEvent",function(e){e&&e.details&&e.details.length&&(t.get("navBarView")&&e.details[0]==="backToList"&&t.get("navBarView").fire.apply(t.get("navBarView"),["parentViewEvent"].concat(e.details)),t.fire.apply(t,e.details))}),t.get("container").one(r.css.subviewContent).appendChild(e.get("container")),s&&(s.append(t.get("container")),t.reposition()),t.activate()},function(e){n.error("Error initializing modal subview",{err:e})})):s&&(s.append(this.get("container")),this.reposition())}return this},reposition:function(){var t=this.get("container"),n=t.one(this.get("modalSelector")),s=e.one(e.config.win),o=parseInt(s.get("innerWidth"),10),u=parseInt(s.get("innerHeight"),10),a=i.modal.width?parseInt(i.modal.width,10):parseInt(n.getComputedStyle("width"),10),f,l=20,c={},h,p,d=n.one(".body"),v=0,m=this.get("showFooter")?parseInt(n.one(".foot").getComputedStyle("height"),10):0,g=0,y=parseInt(d.getComputedStyle("borderTopWidth"),10)+parseInt(d.getComputedStyle("borderBottomWidth"),10),b={};i.modal.height&&(v=parseInt(n.one(".head").getComputedStyle("height"),10),g=i.modal.height,n.get("showFooter")&&(m=parseInt(n.one(".foot").getComputedStyle("height"),10)),i.modal.height+v+m+4*l+y>=u&&(u<=700?g=u-v-m-y:g=u-v-m-4*l-y),n.setStyles({maxHeight:"none"}),this.get("fullWindow")?b.height=g+"px":this.get("maxHeight")&&(b.maxHeight=g+"px"),n.one(r.css.modalContent).setStyles(b)),f=parseInt(n.getComputedStyle("height"),10),h=n.getDOMNode().scrollHeight,p=n.getDOMNode().scrollWidth
,c={top:"50%",left:"50%",width:i.modal.width?a+"px":"",marginTop:-(f/2)+"px",marginLeft:-(a/2)+"px",minWidth:i.modal.minWidth?i.modal.minWidth+"px":""},f+2*l>u||h>f+1||a+2*l>o||p>a?(u<=700&&i.modal.height?c.maxHeight=u-10+"px":(c.maxHeight=u-2*l+"px",c.overflow="auto"),c.maxWidth=o-2*l+"px",c.marginTop=-(Math.min(parseInt(c.maxHeight,10),f)/2)+"px",c.marginLeft=-(Math.min(parseInt(c.maxWidth,10),a)/2)+"px"):(c.maxHeight="inherit",c.maxWidth="inherit",c.overflow="visible"),n.setStyles(c)},handleCancel:function(n){var r=this.get("subview");e.rapidTracker.beacon(t,"modalCancelClick"),r&&r.handleCancel&&r.handleCancel(),this.fire("cancelClick",n),this.close(n)},handleAction:function(e){var t=this.get("subview");this.fire("actionClick",e),t&&t.handleAction&&t.handleAction(),this.get("dismissOnActionClick")&&this.close(e)},close:function(t){e.fire("flickr:removeKeyEventScope",this.getKeyEventScope());var n=this.get("container");this.isClosed=!0,e.one("body").removeClass("scroll-fluid-modal"),this.get("subview")&&this.get("subview").destroy(),this.get("navBarView")&&this.get("navBarView").destroy(),n&&n.remove(!0),this.fire("close",t),this.destroy(),this.get("modalOverlayType").remove(this)},getKeyEventScope:function(){return this.name+this._yuid},destructor:function(){this.unfreeze(),this.detachAll()}},{ATTRS:{showCancelX:{value:!0},showCancelButton:{value:!0},showBodyLines:{value:!1},showActionButton:{value:!0},hideModalOverlay:{value:!1},darkOverlay:{value:!1},actionButtonLabel:{valueFn:function(){return this.intlMessage({intlName:"common.OK"})}},actionButtonIsDangerous:{value:!1},cancelButtonLabel:{valueFn:function(){return this.intlMessage({intlName:"common.CANCEL"})}},actionButtonDisabled:{value:!1},showButtons:{value:!0},dismissOnOverlayClick:{value:!1},dismissOnActionClick:{value:!0},title:{value:""},htmlTitle:{value:""},navBarView:{value:null},message:{value:null},textMessage:{value:null},htmlMessage:{value:null},width:{value:0},minWidth:{value:0},height:{value:0},fullWindow:{value:!1},subview:{value:null},classList:{value:""},buttonFlavorText:{value:""},showButtonFlavorText:{value:!0},showHeader:{value:!0},showFooter:{value:!0},noScroll:{value:!1},maxHeight:{value:!0},modalSelector:{value:".modal"},modalOverlayType:{value:e.OverlayManager.ModalOverlay}}})},"@VERSION@",{requires:["flickr-view","fluid-css","hermes-template-fluid-modal","fluid-overlay-manager-view"],optionalRequires:["fluid"],langBundles:["common"]});
YUI.add("hermes-template-signup-modal",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function h(e,t){var r="",i;return r+=" ",(i=n.signUpHeaderClass)?i=i.call(e,{hash:{},data:t}):(i=e.signUpHeaderClass,i=typeof i===a?i.apply(e):i),r+=f(i),r}function p(e,t){var r="",i;return r+=" style=\"background-image:url('",(i=n.signUpHeaderImage)?i=i.call(e,{hash:{},data:t}):(i=e.signUpHeaderImage,i=typeof i===a?i.apply(e):i),r+=f(i)+"')\"",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.helperMissing;s+='<div class="signup-modal-body">\n	<div class="head',o=n["if"].call(t,t.signUpHeaderClass,{hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i});if(o||o===0)s+=o;s+='"',o=n["if"].call(t,t.signUpHeaderImage,{hash:{},inverse:l.noop,fn:l.program(3,p,i),data:i});if(o||o===0)s+=o;return s+='></div>\n	<h3 class="signup-title">',(o=n.signUpTitle)?o=o.call(t,{hash:{},data:i}):(o=t.signUpTitle,o=typeof o===a?o.apply(t):o),s+=f(o)+'</h3>\n	<p class="signup-message">',(o=n.signUpMessage)?o=o.call(t,{hash:{},data:i}):(o=t.signUpMessage,o=typeof o===a?o.apply(t):o),s+=f(o)+'</p>\n	<button class="large action signup-button">',u={hash:{intlName:"common.SIGN_UP_WITH_YAHOO"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):c.call(t,"intlMessage",u)))+'</button>\n</div>\n<div class="signup-modal-footer">\n	<span>',u={hash:{intlName:"common.HAVE_YAHOO_ACCOUNT"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):c.call(t,"intlMessage",u)))+'</span>\n	<a href="#" class="signin-link">',u={hash:{intlName:"common.SIGN_IN"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):c.call(t,"intlMessage",u)))+"</a>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/signup-modal",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("signup-modal-view",function(e,t){"use strict";var n,r;n={css:{destinationContainer:"body",closeX:".close-x",buttonAction:"button.action",navBarContent:".head .nav",subviewContent:".content.subview",modalContent:".body .content"},options:{}},r={supportsTransform:!1,modal:{height:0,width:0}},e.namespace("Views").SignUpModal=e.FlickrView.create(this.name,e.Views.FluidModal,[],{initializer:function(e){return this.set("showFooter",!1),this.set("showHeader",!1),this.set("showButtonFlavorText",!1),this.set("showButtons",!1),this.set("showActionButton",!1),this.set("showCancelButton",!1),this.set("signUpHeaderClass",e.signUpHeaderClass),this.set("signUpHeaderImage",e.signUpHeaderImage),this.set("signUpTitle",e.signUpTitle),this.set("signUpMessage",e.signUpMessage),this.set("beaconPrefix",e.beaconPrefix),this.set("classList","signup-modal"),this},buildContainer:function(){if(!this.alreadyShowingModal){e.rapidTracker.beacon(this.name,this.get("beaconPrefix")+"ModalShow");var t={signUpHeaderClass:this.get("signUpHeaderClass"),signUpHeaderImage:this.get("signUpHeaderImage"),signUpTitle:this.get("signUpTitle"),signUpMessage:this.get("signUpMessage")};this.set("htmlMessage",this.templates("signup-modal")(t)),this.constructor.superclass.buildContainer.call(this)}return this},activate:function(){return this.get("container").one(".signup-button").on("click",this.handleAction.bind(this)),this.get("container").one(".signin-link").on("click",this.handleSignIn.bind(this)),this.constructor.superclass.activate.call(this),this},handleSignIn:function(t){e.rapidTracker.beacon(this.name,this.get("beaconPrefix")+"ModalSignInClick"),this.fire("signInClick",t),this.constructor.superclass.handleAction.call(this)},handleAction:function(t){e.rapidTracker.beacon(this.name,this.get("beaconPrefix")+"ModalSignUpClick"),this.fire("signUpClick",t),this.constructor.superclass.handleAction.call(this)},handleCancel:function(t){e.rapidTracker.beacon(this.name,this.get("beaconPrefix")+"CancelClick"),this.constructor.superclass.handleCancel.call(this)}})},"@VERSION@",{requires:["flickr-view","fluid-modal-view","hermes-template-signup-modal","signup-modal-css"],optionalRequires:["fluid"],langBundles:["common"]});
YUI.add("hermes-template-signup-interstitial",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=n.helperMissing,f=this.escapeExpression;return s+='<div class="signup-interstitial-body interstitial-fade">\n	<div class="close-x"></div>\n	<div class="body">\n		<div class="logo"></div>\n		<h3 class="signup-interstitial-message">',u={hash:{intlName:"growth.MINI_SIGNUP_FOOTER_MESSAGE_EXPLORE"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):a.call(t,"intlMessage",u)))+'</h3>\n		<div><a href="/signup" class="butt large action signup-button">',u={hash:{intlName:"common.SIGN_UP_WITH_YAHOO"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):a.call(t,"intlMessage",u)))+'</a></div>\n		<a href="/signin" class="signin-link">',u={hash:{intlName:"common.SIGN_IN"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):a.call(t,"intlMessage",u)))+"</a>\n	</div>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/signup-interstitial",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("signup-interstitial-view",function(e,t){"use strict";var n;n={css:{destinationContainer:"body",closeX:".close-x",buttonAction:"button.action",navBarContent:".head .nav",subviewContent:".content.subview",modalContent:".body .content",modalSelector:".modal"},options:{}},e.namespace("Views").SignUpInterstitial=e.FlickrView.create(this.name,e.Views.FluidModal,[],{langBundles:this.details.langBundles,buildContainer:function(){var t=e.one(n.css.destinationContainer);if(!this.alreadyShowingModal){var r={signUpMessage:this.get("signUpMessage")};this.setContainerHTML(this.templates("signup-interstitial")(r)),t&&(t.append(this.get("container")),this.reposition(),this.get("modalOverlayType").get("overlay").removeClass("interstitial-fade"),this.get("container").one(".signup-interstitial-body").removeClass("interstitial-fade"))}return this},activate:function(){var e=this.get("container");this.registerEventHandler(e.one(".signup-button").on("click",this.instrumentSignupClick.bind(this))),this.registerEventHandler(e.one(".signin-link").on("click",this.instrumentSigninClick.bind(this))),this.constructor.superclass.activate.call(this)},instrumentSignupClick:function(n){e.rapidTracker.beacon(t,"signupIntSignupClick")},instrumentSigninClick:function(n){e.rapidTracker.beacon(t,"signupIntSigninClick")},show:function(){e.rapidTracker.beacon(t,"signupIntShown"),this.constructor.superclass.show.call(this)},close:function(n){e.rapidTracker.beacon(t,"signupIntCancelClick"),this.constructor.superclass.close.call(this,n)}},{ATTRS:{showFooter:{value:!1},showHeader:{value:!1},showButtonFlavorText:{value:!1},showButtons:{value:!1},showActionButton:{value:!1},showCancelButton:{value:!1},modalSelector:{value:".signup-interstitial-body"},modalOverlayType:{value:e.OverlayManager.SignupInterstitialOverlay}}})},"@VERSION@",{requires:["flickr-view","fluid-modal-view","hermes-template-signup-interstitial","signup-interstitial-css"],optionalRequires:["fluid"],langBundles:["common","growth"]});
YUI.add("hermes-lang-growth",function(e,t){e.Intl.add("hermes/growth","en-US",{MINI_SIGNUP_FOOTER_MESSAGE:["Never miss a post from ","${username}"],MINI_SIGNUP_FOOTER_MESSAGE_EXPLORE:["Join Flickr to explore world class photos"],MINI_SIGNUP_FOOTER_MESSAGE_SEARCH:["Join Flickr to see more ","${query}"," photos!"]})},"@VERSION@",{requires:["intl"]});
YUI.add("signin-helper",function(e){function t(t,n){e.FlickrStorage.store(t,n)}function n(e,n){var r="fave";t(r,e),m(r,n)}function r(e,t){var n="comment";m(n,t)}function i(e,n){var r="share";t(r,e),m(r,n)}function s(e,n){var r="joingroup";t(r,e),m(r,n)}function o(e,n){var r="follow";t(r,e),m(r,n)}function u(e,n){var r="download";t(r,e),m(r,n)}function a(e,n){var r="fave";t(r,e),y(r,n)}function f(e,t){var n="comment";y(n,t)}function l(e,n){var r="joingroup";t(r,e),y(r,n)}function c(e,n){var r="follow";t(r,e),y(r,n)}function h(e,n){var r="download";t(r,e),y(r,n)}function p(t){var n,r,i=[];if(!t)return;if(e.FlickrStorage.hasEntries()){n=e.FlickrStorage.retrieve();for(r in n)d(t,n[r])||i.push(n[r])}return e.FlickrStorage.remove(),i}function d(e,t){var n=t.key,r=t.value;switch(n){case"fave":return v(e,r),!0;case"share":return!1}}function v(e,t){var n=t.id,r=e.getModelRegistry("photo-engagement-models");r.then(function(e){var t=e.proxy(n);t.registry.addAsFave(n)&&t.remoteUpdate()})}function m(t,n){var r,i;n&&n.withPopup?(r=e.config.win.open(g(n),"_blank","height=650,resizable=1,scrollbars=1,location=yes"),i=setInterval(function(){r.closed&&(clearInterval(i),window.location.reload())},1e3)):e.config.win.location=g(n)}function g(t){t=t||{},t.closeWhenDone&&(t.postLoginUrl=e.url("/photo_grease_postlogin.gne",{protocol:!1}));var n=t.postLoginUrl||e.config.win.location.href,r=t.url||e.url("/signin/yahoo/",{protocol:!1});return r+"?redir="+encodeURIComponent(n)}function y(t,n){n=n||{};var r=n.postLoginUrl||e.config.win.location.href,i=n.url||e.url("/signup/",{protocol:!1});e.config.win.location=i+"?redir="+encodeURIComponent(r)}e.FlickrStorage={_storageKey:"flickrStorage",store:function(t,n){try{var r=[];e.StorageHelper.hasEntries(this._storageKey)&&(r=this.retrieve()),r.push({key:t,value:n}),e.StorageHelper.setItem(this._storageKey,JSON.stringify(r))}catch(i){}},retrieve:function(){var t={};try{t=JSON.parse(e.StorageHelper.getItem(this._storageKey))}catch(n){}return t},remove:function(){try{e.StorageHelper.remove(this._storageKey)}catch(t){}},hasEntries:function(){return e.StorageHelper.hasEntries(this._storageKey)}},e.SigninHelper={savePreLoginAction:t,addPendingFave:n,addPendingComment:r,addPendingShare:i,addPendingFollow:o,addPendingJoinGroup:s,addPendingDownload:u,checkPendingQueue:p,_redirectToSignin:m,_redirectToSignUp:y,_getSigninUrl:g,signUpPendingFave:a,signUpPendingComment:f,signUpPendingFollow:c,signUpPendingJoinGroup:l,signUpPendingDownload:h}},"@VERSION@",{requires:["url","storage-helper"]});
YUI.add("hermes-template-mobile-app-upsell",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function l(e,t){return"is-android"}function c(e,t){return"http://play.google.com/store/apps/details?id=com.yahoo.mobile.client.android.flickr"}function h(e,t){return"http://appstore.com/flickr"}function p(e,t){var r="",i,s;return r+="\n					",s={hash:{intlName:"mobile.APP_ANDROID"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"\n				",r}function d(e,t){var r="",i,s;return r+="\n					",s={hash:{intlName:"mobile.APP_IOS"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"\n				",r}function v(e,t){var r="",i,s;return r+="\n					",s={hash:{intlName:"mobile.APP_ANDROID_FREE"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"\n				",r}function m(e,t){var r="",i,s;return r+="\n					",s={hash:{intlName:"mobile.APP_IOS_FREE"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"\n				",r}function g(e,t){var r="",i,s;return r+="\n					",s={hash:{intlName:"mobile.INSTALL"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"\n				",r}function y(e,t){var r="",i,s;return r+="\n					",s={hash:{intlName:"mobile.GET"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"\n				",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=n.helperMissing,a=this.escapeExpression,f=this;s+='<div id="smartbanner" class="ios">\n	<!-- <button class="sb-close close-banner"></button> -->\n	<div class="sb-container">\n		<span class="sb-icon">\n			<svg class="close-banner icon icon-close"><use xlink:href="#icon-close"></use></svg>\n		</span>\n		<span class="sb-flickr-icon">\n			<div class="outer-logo ',o=n["if"].call(t,t.isAndroid,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='">\n				<div class="ball blue-ball"></div>\n				<div class="ball pink-ball"></div>\n			</div>\n		</span>\n		<div class="sb-info">\n			<a class="sb-button" href="',o=n["if"].call(t,t.isAndroid,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;o=n["if"].call(t,t.isIOS,{hash:{},inverse:f.noop,fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;s+='">\n				<strong>\n				',o=n["if"].call(t,t.isAndroid,{hash:{},inverse:f.noop,fn:f.program(7,p,i),data:i});if(o||o===0)s+=o;s+="\n				",o=n["if"].call(t,t.isIOS,{hash:{},inverse:f.noop,fn:f.program(9,d,i),data:i});if(o||o===0)s+=o;s+="\n				</strong>\n				<span>\n				",o=n["if"].call(t,t.isAndroid,{hash:{},inverse:f.program(13,m,i),fn:f.program(11,v,i),data:i});if(o||o===0)s+=o;s+='\n				</span>\n			</a>\n		</div>\n		<div class="sb-view get-app">\n			<span>\n				',o=n["if"].call(t,t.isAndroid,{hash:{},inverse:f.noop,fn:f.program(15,g,i),data:i});if(o||o===0)s+=o;s+="\n				",o=n["if"].call(t,t.isIOS,{hash:{},inverse:f.noop,fn:f.program(17,y,i),data:i});if(o||o===0)s+=o;return s+="\n			</span>\n		</div>\n	</div>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/mobile-app-upsell",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("mobile-app-upsell-view",function(e){var t="show-upsell-banner";e.namespace("Views")[this.name]=e.Base.create("mobile-app-upsell-view",e.FlickrView,[],{langBundles:["common","mobile"],initializer:function(e){return this.nsid=e.nsid,this.photoId=e.photoId,this.buildContainer(),this},buildContainer:function(){var e=this.appContext.getUA().os;return this.setContainerHTML(this.templates("mobile-app-upsell")({isAndroid:e==="android",isIOS:e==="ios"})),this},setRootViewAdditionalViewClasses:function(){var e=[],n=this.appContext.getUA().os;return e.push(n),e.push(t),this.set("rootViewAdditionalViewClasses",e),this},activate:function(){var t=this.get("container"),n=t.one(".close-banner"),r=t.one(".get-app"),i=this;return n&&this.registerEventHandler(i.addBannerEvent(n,"dism",i.dismissBanner.bind(i))),r&&this.registerEventHandler(i.addBannerEvent(r,"inst",i.installApp.bind(i))),e.rapidTracker.beacon(this.name,"app_promo_interstitial_shown",{section:"app-interstitial"}),this},addBannerEvent:function(e,t,n){var r=this;return e.on("click",function(e){e.preventDefault(),r.appContext.setCookie({cookieName:t,path:"/",cookieValue:!0,remove:!0}),r.fire("subviewViewEvent","removeUpsell"),n()})},dismissBanner:function(){if(navigator.cookieEnabled){e.rapidTracker.beacon(this.name,"cookies_off",{section:"app-interstitial"});return}var t=parseInt(this.appContext.getCookie("flaidisn"),10);!t||isNaN(t)?t=0:t+=1,e.rapidTracker.beacon(this.name,"app_promo_interstitial_dismissed"+(t>0?"_"+(t+1):""),{section:"app-interstitial"});var n;t<2?n=e.moment().add(3,"days").toDate():t===2?n=e.moment().add(7,"days").toDate():t===3&&(n=e.moment().add(20,"year").toDate()),this.appContext.setCookie({cookieName:"flaidisn",cookieValue:1,expires:n,remove:!0,path:"/"})},installApp:function(){var t=this.appContext.getUA().os,n=this.appContext.getUA().isWebview,r="photos/"+this.nsid+"/"+this.photoId,i=this;e.rapidTracker.beacon(this.name,"app_promo_interstitial_download",{section:"app-interstitial"}),this.appContext.setCookie({cookieName:"flaidis",cookieValue:1,expires:e.moment().add(20,"year").toDate(),remove:!0,path:"/"}),setTimeout(function(){e.use("mobile-actions-helper",function(e){e.MobileActionsHelper.redirectToAppOrStore({os:t,isWebview:n,pageURL:r,beacon:{name:"app_promo_banner_open",section:"appbanner"},viewName:i.name})})},250)}},{ATTRS:{}}),e.namespace("Views")[this.name].shouldShowBanner=function(e){var t=e.getCookie("dism")||e.getCookie("inst"),n=e.getUA().os,r=n==="ios"||n==="android";return!t&&r}},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-mobile-app-upsell","mobile-app-upsell-css"],langBundles:["common","mobile"]});
YUI.add("hermes-lang-mobile",function(e,t){e.Intl.add("hermes/mobile","en-US",{APP_IOS:["Flickr for iOS"],APP_ANDROID:["Flickr for Android"],APP_IOS_FREE:["Free in the App Store"],APP_ANDROID_FREE:["Free in the Google Play"],GET:["Get"],INSTALL:["Install"]})},"@VERSION@",{requires:["intl"]});
YUI.add("global-nav-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){var n,r;typeof t.enableBrowserUpgradeBanner=="undefined"&&(t.enableBrowserUpgradeBanner=!0),this.set("showBrowserUpgradeBanner",!1);if(YUI.Env.isServer&&t.enableBrowserUpgradeBanner){var i=this.appContext.request.headers["user-agent"],s=e.BrowserSupport.isUnsupportedBrowser(i),o=e.BrowserSupport.isBot(i),u=e.BrowserSupport.isSharingBot(i);s&&!o&&!u&&this.set("showBrowserUpgradeBanner",!0)}if(!YUI.Env.isServer){var a=e.StorageHelper.getItem("hasDismissedBrowserUpgradeBanner",!0);a&&a==="true"&&this.set("showBrowserUpgradeBanner",!1)}return this.get("container").get("innerHTML")===""&&this.setContainerHTML('<div class="global-nav-content"></div>'),this.appStateParams=t,this.enableMobileNav=t.enableMobileNav||!1,n=this.appContext.getLocation(),t.modelParams&&t.modelParams.apiParams?r=t.modelParams.apiParams:r=n.href,this.searchUrl=new e.SearchUrl(r,this.appContext,t.searchType),this.useGlobalNavRestyle=t.useGlobalNavRestyle,this.appContext.flipper.isFlipped("enable-signed-out-cta-test")&&(this.signedOutTest=!0),this.appContext.flipper.isFlipped("enable-sign-up-interstitial-test")&&this.appContext.lang.toLowerCase()==="en-us"&&(this.signUpInterstitialTest=!0),this.appContext.flipper.isFlipped("enable-sign-up-rail-test")&&this.appContext.lang.toLowerCase()==="en-us"&&!this.appContext.getViewer().signedIn&&!t.isSOHP&&(this.signUpRailTest=!0),this},subviewConfig:{"search-autosuggest-field-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!this.appContext.flipper.isFlipped("enable-new-autosuggest")}},"autosuggest-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,disabled:function(){return this.enableMobileNav||!this.appContext.flipper.isFlipped("autosuggest2")}},"search-bar-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,disabled:function(){return!this.appContext.flipper.isFlipped("autosuggest")}},"account-menu-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"notifications-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,disabled:function(){return!this.appContext.flipper.isFlipped("notifications-menu")}},"browser-upgrade-banner-view":{requiredToShowOnServer:!0,requiredToShowOnClient:!1,dealbreaker:!1,disabled:function(){return!this.get("showBrowserUpgradeBanner")}},"person-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,containerSelector:"#content",excludeSelectors:[".c-account-menu"],disabled:function(){return!this.appContext.flipper.isFlipped("enable-hover-account-menu")||!this.appContext.flipper.isFlipped("rebootify-group-discussions-list")}},"group-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,containerSelector:"#content",excludeSelectors:[".c-account-menu"],disabled:function(){return!this.appContext.flipper.isFlipped("enable-hover-account-menu")||!this.appContext.flipper.isFlipped("rebootify-group-discussions-list")}},"mobile-app-upsell-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(t){return!t.isMobile||!e.Views["mobile-app-upsell-view"].shouldShowBanner(this.appContext)}},"signup-rail-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,additionalViewClasses:["collapsed"],disabled:function(e){return e.isMobile||!this.signUpRailTest}}},loadState:function(){var t=this,n=this.appContext.getViewer(),r;return n.signedIn?r=this.appContext.getModel("person-models",n.nsid).then(function(e){t.set("viewer",e),t.elementStates=t.setElementStates(t.appStateParams)}):(this.elementStates=this.setElementStates(this.appStateParams),r=e.Promise.resolve()),r},buildContainer:function(){var t={},n;return this.get("viewer")&&(t=e.merge(this.get("viewer").toJSON(),{urls:e.URLHelper.generatePersonUrls(this.get("viewer"))})),n={"account-menu-view":this.subviews["account-menu-view"].get("container"),"browser-upgrade-banner-view":this.subviews["browser-upgrade-banner-view"]?this.subviews["browser-upgrade-banner-view"].get("container"):"","show-browser-upgrade-banner":this.get("showBrowserUpgradeBanner"),showNotificationsMenu:!1,viewer:t,elements:this.elementStates,enableMobileNav:this.enableMobileNav,enableNewAutosugest:this.appContext.flipper.isFlipped("enable-new-autosuggest"),enableVRLanding:this.appContext.flipper.isFlipped("enable-vr-landing"),showSmartSearchBar:this.appContext.flipper.isFlipped("autosuggest"),showAutosuggest:!this.enableMobileNav&&this.appContext.flipper.isFlipped("autosuggest2"),searchValue:this.searchUrl.getSearchTerm(),"person-menu-view":this.subviews["person-menu-view"]?this.subviews["person-menu-view"].get("container"):"","group-menu-view":this.subviews["group-menu-view"]?this.subviews["group-menu-view"].get("container"):"","mobile-app-upsell-view":this.subviews["mobile-app-upsell-view"]?this.subviews["mobile-app-upsell-view"].get("container"):"","signup-rail-view":this.subviews["signup-rail-view"]?this.subviews["signup-rail-view"].get("container"):""},n.showAutosuggest?n["autosuggest-view"]=this.subviews["autosuggest-view"].get("container"):n.showSmartSearchBar?n["search-bar-view"]=this.subviews["search-bar-view"].get("container"):n.enableNewAutosugest&&(n["search-autosuggest-field-view"]=this.subviews["search-autosuggest-field-view"].get("container")),this.appContext.flipper.isFlipped("notifications-menu")&&(n["notifications-menu-view"]=this.subviews["notifications-menu-view"].get("container"),n.showNotificationsMenu=!0),this.appContext.flipper.isFlipped("global-nav-restyle")||this.useGlobalNavRestyle?this.setContainerHTML(this.templates("global-nav-restyle")(n)):this.setContainerHTML(this.templates("global-nav")(n)),this},activate:function(){var t=this,n=this.appContext.getViewer().prefs.keyboardShortcutsEnabled,r,i,s,o=this.get("container");i=["photo-page-ad-scrappy-view","sohp-view","products-landing-view","products-marketplace-products-view"],r=this.appContext.flapp.get("activeView").name,n&&
this.attachKeyEvent("up:83",this.focusSearch.bind(this)),t.subviews["autosuggest-view"]&&(this.registerEventHandler(this.subviews["autosuggest-view"].on("open",function(e){t.subviews["account-menu-view"].closeMenu()})),this.registerEventHandler(this.subviews["account-menu-view"].on("open",function(e){t.subviews["autosuggest-view"].close()}))),this.elementStates.search_bar&&!this.appContext.flipper.isFlipped("enable-new-autosuggest")&&(s=o.one(".gn-tools form"),s&&this.registerEventHandler(s.on("submit",this.executeSearch.bind(this))));if(this.appContext.flipper.isFlipped("global-nav-restyle")||this.useGlobalNavRestyle)this.registerEventHandler(o.one(".mobile-nav-toggle").on("click",function(n){e.rapidTracker.beacon(t.name,"mobile-nav-toggle",{action:o.one(".global-nav-restyle").hasClass("menu-open")?"close":"open"}),o.one(".global-nav-restyle").toggleClass("menu-open")}.bind(this))),this.registerEventHandler(o.one(".mobile-search-button").on("click",function(n){e.rapidTracker.beacon(t.name,"mobile-nav-search");var r=this.get("container"),i=r.one(".global-nav-restyle"),s=r.one("#gn-search-field"),o=this.appContext.viewportData.getWidth(),u=37,a=46;i.addClass("search-open"),i.hasClass("menu-open")&&i.removeClass("menu-open"),t.appContext.flipper.isFlipped("enable-new-autosuggest")?(t.fire("parentViewEvent","resize-search-field",o-a),t.fire("parentViewEvent","focus-search-field")):(t.appContext.flipper.isFlipped("autosuggest")&&(s=r.one("#autosuggest-input"),a=42),s.setStyles({width:o-u-a+"px"}).focus())}.bind(this))),this.registerEventHandler(o.one(".mobile-search-close-button").on("click",function(e){o.one(".global-nav-restyle").removeClass("search-open"),t.appContext.flipper.isFlipped("autosuggest")?o.one(".global-nav-restyle #autosuggest-input").set("value",""):t.appContext.flipper.isFlipped("enable-new-autosuggest")?t.fire("parentViewEvent","clear-search-field"):o.one(".global-nav-restyle #gn-search-field").set("value","")}.bind(this))),this.registerEventHandler(e.globalEvents.subscribe("window:resize",function(e){o.one(".global-nav-restyle").removeClass("search-open"),t.appContext.flipper.isFlipped("autosuggest")?o.one(".global-nav-restyle #autosuggest-input").set("value","").setStyles({width:"183px"}):t.appContext.flipper.isFlipped("enable-new-autosuggest")?t.fire("parentViewEvent","resize-search-field"):o.one(".global-nav-restyle #gn-search-field").set("value","").setStyles({width:"183px"})}.bind(this)));return this.appContext.getViewer().signedIn||(this.signedOutTest&&this.registerEventHandler(o.one(".gn-upload .gn-title").on("click",this.signUpAndUpload.bind(this))),i.indexOf(r)<0&&!this.appContext.getUA().isMobileBrowser&&this.signUpInterstitialTest&&this.startInterstitialTimer()),this},startInterstitialTimer:function(){var t=this,n,r=!1,i;n=e.StorageHelper.getItem("signUpInterstitialSeen"),n?(n=e.moment(n,"x"),i=e.moment().subtract(2,"days"),i>n&&(r=!0)):r=!0,r&&(this.signUpInterstitialTimer=setTimeout(function(){if(!e.OverlayManager.hasOverlay()&&e.config.win.innerWidth>700){var n=new e.Views.SignUpInterstitial({appContext:t.appContext});n.show(),e.StorageHelper.setItem("signUpInterstitialSeen",e.moment().format("x"))}},4e3))},destructor:function(){clearTimeout(this.signUpInterstitialTimer)},signUpAndUpload:function(t){var n=e.url("/upload/"),r=this.intlMessage({intlName:"global-nav.UPLOAD_MODAL_SIGNUP_TITLE"}),i=this.intlMessage({intlName:"global-nav.UPLOAD_MODAL_SIGNUP_MESSAGE"}),s;t.halt(),e.rapidTracker.beacon(this.name,"uploadButtonClick"),s=new e.Views.SignUpModal({appContext:this.appContext,signUpHeaderClass:"signup-upload",signUpTitle:r,signUpMessage:i,beaconPrefix:"upload"}),s.on("signUpClick",function(t){e.SigninHelper._redirectToSignUp("upload",{postLoginUrl:n})}),s.on("signInClick",function(t){e.SigninHelper._redirectToSignin("upload",{postLoginUrl:n})}),s.show()},focusSearch:function(e){this.appContext.flipper.isFlipped("autosuggest")?this.subviews["search-bar-view"].get("container").one("#autosuggest-input").focus():this.appContext.flipper.isFlipped("enable-new-autosuggest")||this.get("container").one("#gn-search-field").focus()},executeSearch:function(e){var t=this.get("container").one("#gn-search-field").getDOMNode(),n;n=this.searchUrl.createNewSearch(t.value).getURL(),e.halt(),this.appContext.flapp.navigate(n)},setElementStates:function(e){var t={small_logo:!1,you_link:!1,you_menu:!1,contacts_menu:!1,groups_menu:!1,explore_menu:!1,weekly_flickr:!1,create_link:!1,create_menu:!1,upload_link:!1,upload_icon:!1,account_menu:!1,search_bar:!1,tour_link:!1,signup_link:!1,signin_link:!1,pro_upsell:!1,chronic_link:!1,editr_tour_link:!1,use_uh_eyebrow:!1,right_side_signup:!1},n=this.appContext.getViewer();return!this.appContext.flipper.isFlipped("global-nav-restyle")&&!this.useGlobalNavRestyle?(e.isJobs?t.small_logo=!0:e.isPlayr?t.use_uh_eyebrow=!1:e.isEditr?(t.small_logo=!0,t.you_link=!0,t.chronic_link=!0,t.editr_tour_link=!0,t.account_menu=!0,t.use_uh_eyebrow=!1):e.isHome&&!n.signedIn?(t.tour_link=!0,t.signup_link=!0,t.explore_menu=!0,t.upload_link=!0,t.search_bar=!0,t.signin_link=!0):n.signedIn?(t.you_menu=!0,t.contacts_menu=!0,t.groups_menu=!0,t.explore_menu=!0,t.upload_link=!0,t.search_bar=!0,t.account_menu=!0):(t.tour_link=!0,t.signup_link=!0,t.explore_menu=!0,t.upload_link=!0,t.search_bar=!0,t.signin_link=!0),this.get("viewer")&&(this.appContext.flipper.isFlipped("rebootify-stats")||this.get("viewer").getValue("isPro"))&&(t.stats=!0),this.appContext.lang.toLowerCase()==="en-us"&&(t.weekly_flickr=!0),t.create_link=!0,t.set_not_album=!this.appContext.flipper.isFlipped("rename-set-to-album")):(e.isJobs?t.small_logo=!0:e.isPlayr?t.use_uh_eyebrow=!1:e.isEditr?(t.small_logo=!0,t.you_link=!0,t.chronic_link=!0,t.editr_tour_link=!0,t.account_menu=!0,t.use_uh_eyebrow=!1):e.isHome&&!n.signedIn?(t.tour_link=!0,t.signup_link=!0,t.explore_menu=!0,t.upload_link=!0,t.search_bar=!0,t.signin_link=!0):n.signedIn?(t.you_menu=!0,t.explore_menu=!0,t.upload_link=!0,t.search_bar=!0,t.account_menu=!0
):(t.tour_link=!0,t.signup_link=!0,t.explore_menu=!0,t.upload_link=!0,t.search_bar=!0,t.signin_link=!0),this.get("viewer")&&(this.appContext.flipper.isFlipped("rebootify-stats")||this.get("viewer").getValue("isPro"))&&(t.stats=!0),this.appContext.lang.toLowerCase()==="en-us"&&(t.weekly_flickr=!0),t.create_link=!0,t.set_not_album=!this.appContext.flipper.isFlipped("rename-set-to-album"),this.appContext.flipper.isFlipped("enable-global-nav-upload-icon")&&(t.upload_link=!1,t.upload_icon=!0),this.appContext.flipper.isFlipped("rebootify-tags")?t.show_tags_menu_link=!0:t.show_tags_menu_link=!1,this.signedOutTest&&(t.right_side_signup=!0)),t},onSubviewEvent:function(e,t){t&&e==="mobile-app-upsell-view"&&t[0]==="removeUpsell"&&this.subviews["mobile-app-upsell-view"].destroy({remove:!0})}})},"@VERSION@",{requires:["flickr-view","hermes-template-global-nav","hermes-template-global-nav-restyle","global-nav-css","global-nav-restyle-css","search-url","search-autosuggest-field-view","autosuggest-view","search-bar-view","querystring-parse-simple","querystring-stringify-simple","notifications-menu-view","fluid-css","url-helper","person-menu-view","group-menu-view","browser-support","fluid-modal-view","signup-modal-view","signup-interstitial-view","signin-helper","storage-helper","mobile-app-upsell-view"],langBundles:["global-nav","common","search"]});
YUI.add("hermes-lang-global-nav",function(e,t){e.Intl.add("hermes/global-nav","en-US",{FLICKR_LOGO_ALT:["Flickr logo. If you click it, you'll go home"],YOUR_PHOTOSTREAM:["Your Photostream"],FOLLOWING:["Following"],PHOTOS_OF:["Photos of"],PHOTOS_FROM:["Photos from"],LIST:["List"],COMMUNITIES:["Communities"],GROUPS_LIST:["Groups List"],SEARCH_GROUPS:["Search Groups"],RECENT_DISCUSSIONS:["Recent Discussions"],CREATE_A_GROUP:["Create a Group"],RECENT_PHOTOS:["Recent Photos"],THE_COMMONS:["The Commons"],GETTY_COLLECTION:["Getty Collection"],GALLERIES:["Galleries"],FLICKR_GALLERIES:["Flickr Galleries"],WORLD_MAP:["World Map"],APP_GARDEN:["App Garden"],THE_WEEKLY_FLICKR:["The Weekly Flickr"],FLICKR_BLOG:["Flickr Blog"],UPLOAD:["Upload"],SIGN_IN:["Sign In"],SEARCH:["Search"],CAMERA_FINDER:["Camera Finder"],RECENT_ACTIVITY:["Recent Activity"],STATS:["Stats"],ORGANIZE:["Organize"],CREATIONS:["Creations"],FIND_FRIENDS:["Find Friends"],GROUPS:["Groups"],PEOPLE:["People"],CAMERAROLL:["Camera Roll"],CREATE:["Create"],UPLOAD_MODAL_SIGNUP_TITLE:["Upload your photos securely and privately!"],UPLOAD_MODAL_SIGNUP_MESSAGE:["Join Flickr to unlock 1,000GB of free photo storage."]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-template-darla-script-setup",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t,n){var r="",i;return r+="\n<script>\n	var lang = '"+l((i=(i=n.selectedLang,i==null||i===!1?i:i.code),typeof i===f?i.apply(e):i))+'\';\n\n	if (lang === \'de-DE\') {\n		/* this should run out of band */\n		setTimeout(function () {\n			var darlaScriptElement = document.createElement("script");\n			darlaScriptElement.setAttribute("defer", "true");\n			darlaScriptElement.setAttribute("async", "true");\n			darlaScriptElement.setAttribute("src", "https://fc.yahoo.com/sdarla/php/client.php?f=2022219890&l=RS&npv=1&ref=https%3A//flickr.com&rtype=boot");\n			// for the future -- darlaScriptElement.onerror = function(){};\n			document.getElementsByTagName(\'head\')[0].appendChild(darlaScriptElement);\n		}, 100);\n	}\n</script>\n',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;a={hash:{},inverse:c.noop,fn:c.programWithDepth(1,p,i,t),data:i},u=(o=n.isFlipped||t.isFlipped,o?o.call(t,t.flippers,"enable-darla-beacon",a):h.call(t,"isFlipped",t.flippers,"enable-darla-beacon",a));if(u||u===0)s+=u;return s+="\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/darla-script-setup",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
